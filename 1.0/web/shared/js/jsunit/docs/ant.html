<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!--
JsUnit - a JUnit port for JavaScript
Copyright (C) 1999,2000,2001,2002,2003,2006,2007 Joerg Schaible

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<html><head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>JsUnit: Apache Ant</title>
<link href="JsUnit.css" rel="stylesheet" type="text/css">
</head><body>
<table width="100%" class="header"><tr>
<td width="100%"><div class="header"><span class="J">J</span><span class="s">s</span><span class="U">U</span>nit <small>1.3</small></div></td>
<td>
<form action="https://www.paypal.com/cgi-bin/webscr" method="post">
<input type="hidden" name="cmd" value="_xclick">
<input type="hidden" name="business" value="joehni@mail.berlios.de">
<input type="hidden" name="item_name" value="JsUnit">
<input type="image" src="PayPal.png" border="0" name="submit" alt="Make a donation using PayPal">
</form></td>
<td><a href="http://developer.berlios.de/projects/jsunit"><img name="HeadBerliOS" src="berlios.png" width="118" height="52" border="0" alt="Project Developer Home"></a></td>
<td><a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border=0 width=110 height=52></a></td>
</tr></table>
<script type="text/javascript" language="JavaScript">
<!--
// Reference BerliOS if viewed in the web.
if(   window.location.protocol.indexOf( "http", 0 ) == 0
   && window.location.host != "localhost" 
   && window.location.host != "127.0.0.1" )
{
    document.HeadBerliOS.src = "http://developer.berlios.de/sflogo.php?group_id=158&type=1";
}
//-->
</script>
<hr>

<!-- Generated by Doxygen 1.5.2 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="classes.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul>
</div>
<h1><a class="anchor" name="ant">Apache Ant</a></h1> 

<div class="JsUnit">

<p>
<a href="http://ant.apache.org/">Ant</a> is a build tool from the Apache Software Foundation generally used for Java development. Ant uses an XML-based build script (by default <em>build.xml</em> to define build targets. Each target consists of a sequence of tasks that must be executed. Typically exists a target <em>test</em> that builds the project (because of a dependency to the <em>compile</em> target), runs the tests (as a result of executing the <em>junit</em> task) and creates a test report (created by the <em>junitreport</em> task).<p>
Especially in Java-based web projects exists often also JavaScript files that are included into HTML pages. Such files can contain methods and JavaScript classes that should be also tested like the other Java source. JsUnit provides therefore a <em>jsunit</em> task that can be used as replacement or in addition to a <em>junit</em> task. It generates the XML in the same format that is used later on by the <em>jsunitreport</em> task to generate the reports.<p>
The <em>jsunit</em> task embeds <a class="el" href="rhino.html">Rhino</a> to perform the JavaScript tests. <h2><a class="anchor" name="antdownload">
Download Ant Task</a></h2>
The Ant task is available from the Maven 2 repository of JsUnit at BerliOS, download <a href="http://jsunit.berlios.de/maven2/repo/de/berlios/jsunit/jsunit-ant/1.3/jsunit-ant-1.3.jar">here</a>.<h2><a class="anchor" name="antsetup">
Setting up Ant</a></h2>
To run the JsUnit task you must setup Ant. It must find during execution the Java classes of the task itself and the classes the task is dependent on. Following Jars are necessary: <ul>
<li>
jsunit.jar: Jar with the JsUnit JavaScript library and utility classes to invoke Rhino </li>
<li>
jsunit-ant.jar: Jar with the Ant task </li>
<li>
js.jar: Rhino, embeddable JavaScript engine </li>
</ul>
<p>
You may provide them on command line calling Ant with the <em>lib</em> option, add them to the CLASSPATH, or put them into Ant's lib directory.<p>
Note, that depending on the on the Ant installation it often happens that the <em>junitreport</em> task fails with a missing classes <em>org.apache.xalan.processor.TransformerFactoryImpl</em> or <em>org.apache.xml.serializer.SerializerTrace</em>. Reason is a missing Xalan version. Take a recent one (&gt;= 2.5) and add it to Ant's <em>lib</em> directory. Take care what you add. The binary distribution of Xalan comes with multiple jars, you have to add <em>xalan_j.jar</em> and <em>serializer.jar</em>. If you take the Xalan version located in the Maven repository anything is already included.<h2><a class="anchor" name="anttask">
Using the Ant Task</a></h2>
The JsUnit Ant task has to be declared first<p>
<div class="fragment"><pre class="fragment">&lt;taskdef name=<span class="stringliteral">"jsunit"</span> className=<span class="stringliteral">"de.berlios.jsunit.ant.JsUnitTask"</span> /&gt;
</pre></div><p>
The task itself has a <em>dir</em> attribute that defines the root directory for all following file declarations. A JsUnit task may contain multiple <em>source</em> and <em>testsuite</em> subtasks. A JavaScript file to test is declared with every source tag using the <em>file</em> attribute. The reason for an explicit declaration is a possible dependency between the files, that is resolved by loading them in the declared sequence.<p>
The JavaScript test files are declared using the <em>testsuite</em> subtasks. A <a class="el" href="classTestSuite.html" title="A TestSuite is a composition of Tests.">TestSuite</a> subtask supports following attributes:<p>
<ul>
<li>
<b>name</b>: The name of the test suite </li>
<li>
<b>todir</b>: The target directory for the test results </li>
<li>
<b>type</b>: The type of the test suite, one of the following values: <dl>
<dt>ALLTESTS </dt>
<dd>Looks for a class AllTests derived from <a class="el" href="classTestSuite.html" title="A TestSuite is a composition of Tests.">TestSuite</a> and runs its suite. </dd>
<dt>TESTSUITES </dt>
<dd>Looks for all classes ending with <a class="el" href="classTestSuite.html" title="A TestSuite is a composition of Tests.">TestSuite</a> and that are derived from <a class="el" href="classTestSuite.html" title="A TestSuite is a composition of Tests.">TestSuite</a> and run their suites. </dd>
<dt>TESTCASES </dt>
<dd>Looks for all classes ending with <a class="el" href="classTestCase.html" title="A test case defines the fixture to run multiple tests.">TestCase</a> and that are derived from <a class="el" href="classTestCase.html" title="A test case defines the fixture to run multiple tests.">TestCase</a> and runs them (the default). </dd>
</dl>
</li>
<li>
<b>characterSet</b>: The optional character set for the encoding </li>
</ul>
<h2><a class="anchor" name="antexample">
Example build.xml</a></h2>
The following JsUnit task is used in the Ant build script of the samples directory.<p>
 <div class="fragment"><pre class="fragment">        &lt;jsunit haltonerror=<span class="stringliteral">"false"</span> haltonfailure=<span class="stringliteral">"false"</span>&gt;
            &lt;source file=<span class="stringliteral">"money/IMoney.js"</span> /&gt;
            &lt;source file=<span class="stringliteral">"money/Money.js"</span> /&gt;
            &lt;source file=<span class="stringliteral">"money/MoneyBag.js"</span> /&gt;
            &lt;source file=<span class="stringliteral">"demo/Demo.js"</span> /&gt;
            &lt;testsuite name=<span class="stringliteral">"LocalTests"</span> todir=<span class="stringliteral">"${test.reports.dir}"</span>&gt;
                &lt;fileset dir=<span class="stringliteral">"."</span>&gt;
                    &lt;include name=<span class="stringliteral">"*Test.js"</span> /&gt;
                &lt;/fileset&gt;
            &lt;/testsuite&gt;
            &lt;testsuite name=<span class="stringliteral">"MoneyTests"</span> todir=<span class="stringliteral">"${test.reports.dir}"</span>&gt;
                &lt;fileset dir=<span class="stringliteral">"."</span>&gt;
                    &lt;include name=<span class="stringliteral">"money/**Test.js"</span> /&gt;
                &lt;/fileset&gt;
            &lt;/testsuite&gt;
            &lt;testsuite name=<span class="stringliteral">"DemoSuite"</span> todir=<span class="stringliteral">"${test.reports.dir}"</span> characterSet=<span class="stringliteral">"UTF-8"</span>&gt;
                &lt;fileset dir=<span class="stringliteral">"."</span>&gt;
                    &lt;include name=<span class="stringliteral">"demo/**Test.js"</span> /&gt;
                &lt;/fileset&gt;
            &lt;/testsuite&gt;
        &lt;/jsunit&gt;
</pre></div><p>
 

</div>

 <hr>
<table width="100%" class="header">
    <tr>
        <td>
            <div align="left">
            <small>JsUnit &copy; 1999, 2000, 2001, 2002, 2003, 2006, 2007 by J&ouml;rg Schaible</small>
            </div>
        </td>
        <td>
            <div align="right">
                <small>Generated on Fri Oct 19 23:10:41 2007 for <b>JsUnit</b> by <a href="http://www.doxygen.org/index.html">doxygen</a> 1.5.2</small>
            </div>
        </td>
    </tr>
</table>
</body>
</html>
