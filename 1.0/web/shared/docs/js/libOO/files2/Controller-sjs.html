<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">

<html><head><title>Controller - Myna Application Server</title><link rel="stylesheet" type="text/css" href="../styles/main.css"><script language=JavaScript src="../javascript/main.js"></script><script language=JavaScript src="../javascript/searchdata.js"></script><script type="text/javascript" src="../shjs/sh_main.js"></script><script type="text/javascript" src="../shjs/lang/sh_myna.js"></script><link type="text/css" rel="stylesheet" href="../shjs/css/sh_mild_white.css"><script type="text/javascript" src="../../../../js/shjs/sh_main.js"></script><script type="text/javascript" src="../../../../js/shjs/lang/sh_myna.js"></script><link type="text/css" rel="stylesheet" href="../../../../js/shjs/css/sh_mild_white.css"><script type="text/javascript" src="../../../../../js/shjs/sh_main.js"></script><script type="text/javascript" src="../../../../../js/shjs/lang/sh_myna.js"></script><link type="text/css" rel="stylesheet" href="../../../../../js/shjs/css/sh_mild_white.css"></head><body id=ContentPage onLoad="NDOnLoad();sh_highlightDocument();"><script language=JavaScript><!--
if (browserType) {document.write("<div id=" + browserType + ">");if (browserVer) {document.write("<div id=" + browserVer + ">"); }}// --></script>

<!--  Generated by Natural Docs, version Development Release 02-10-2007 (1.35 base) -->
<!--  http://www.naturaldocs.org  -->

<!-- saved from url=(0026)http://www.naturaldocs.org -->




<div id=Content><div class="CClass CTopic" id=MainTopic><h1 class=CTitle><a name="Controller"></a>Controller</h1><div class=CBody><p class=CParagraph>base Controller class for FlightPath</p><!--START_ND_SUMMARY--><div class=Summary><div class=STitle>Summary</div><div class=SBody><table border=0 cellspacing=0 cellpadding=0 class=STable><tr class="SMain"><td class=SEntry><a href="#Controller" >Controller</a></td><td class=SDescription>base Controller class for FlightPath</td></tr><tr class="SGroup SIndent1"><td class=SEntry><a href="#Controller.Properties" >Properties</a></td><td class=SDescription></td></tr><tr class="SProperty SIndent2 SMarked"><td class=SEntry><a href="#Controller.$page" >$page</a></td><td class=SDescription>$page metadata object</td></tr><tr class="SGroup SIndent1"><td class=SEntry><a href="#Controller.Functions" >Functions</a></td><td class=SDescription></td></tr><tr class="SFunction SIndent2 SMarked"><td class=SEntry><a href="#Controller.addLayout" id=link1 onMouseOver="ShowTip(event, 'tt1', 'link1')" onMouseOut="HideTip('tt1')">addLayout</a></td><td class=SDescription>adds a layout layer to this this request</td></tr><tr class="SFunction SIndent2"><td class=SEntry><a href="#Controller.setLayout" id=link2 onMouseOver="ShowTip(event, 'tt2', 'link2')" onMouseOut="HideTip('tt2')">setLayout</a></td><td class=SDescription>Sets a single layout layer to this this request, clearing any existing layouts</td></tr><tr class="SFunction SIndent2 SMarked"><td class=SEntry><a href="#Controller.addFilter" id=link3 onMouseOver="ShowTip(event, 'tt3', 'link3')" onMouseOut="HideTip('tt3')">addFilter</a></td><td class=SDescription>adds an action filter</td></tr><tr class="SFunction SIndent2"><td class=SEntry><a href="#Controller.applyBehavior" id=link4 onMouseOver="ShowTip(event, 'tt4', 'link4')" onMouseOut="HideTip('tt4')">applyBehavior</a></td><td class=SDescription>loads a behavior and applies it to this object</td></tr><tr class="SFunction SIndent2 SMarked"><td class=SEntry><a href="#Controller.getFilters" id=link5 onMouseOver="ShowTip(event, 'tt5', 'link5')" onMouseOut="HideTip('tt5')">getFilters</a></td><td class=SDescription>returns the filter array for the requested event and action.</td></tr><tr class="SFunction SIndent2"><td class=SEntry><a href="#Controller.getActions" id=link6 onMouseOver="ShowTip(event, 'tt6', 'link6')" onMouseOut="HideTip('tt6')">getActions</a></td><td class=SDescription>returns an array of objects for each action that contain the action name and action function.</td></tr><tr class="SFunction SIndent2 SMarked"><td class=SEntry><a href="#Controller.callAction" id=link7 onMouseOver="ShowTip(event, 'tt7', 'link7')" onMouseOut="HideTip('tt7')">callAction</a></td><td class=SDescription>Call an action as an inline function.</td></tr><tr class="SFunction SIndent2"><td class=SEntry><a href="#Controller.include" id=link8 onMouseOver="ShowTip(event, 'tt8', 'link8')" onMouseOut="HideTip('tt8')">include</a></td><td class=SDescription>Call an action and includes its output in the current request</td></tr><tr class="SFunction SIndent2 SMarked"><td class=SEntry><a href="#Controller.render" id=link9 onMouseOver="ShowTip(event, 'tt9', 'link9')" onMouseOut="HideTip('tt9')">render</a></td><td class=SDescription>renders a view</td></tr><tr class="SFunction SIndent2"><td class=SEntry><a href="#Controller.renderContent" id=link10 onMouseOver="ShowTip(event, 'tt10', 'link10')" onMouseOut="HideTip('tt10')">renderContent</a></td><td class=SDescription>Directly render content, bypassing default render</td></tr></table></div></div><!--END_ND_SUMMARY--></div></div>

<div class="CGroup CTopic"><h3 class=CTitle><a name="Controller.Properties"></a>Properties</h3></div>

<div class="CProperty CTopic"><h3 class=CTitle><a name="Controller.$page"></a>$page</h3><div class=CBody><p class=CParagraph>$page metadata object</p></div></div>

<div class="CGroup CTopic"><h3 class=CTitle><a name="Controller.Functions"></a>Functions</h3></div>

<div class="CFunction CTopic"><h3 class=CTitle><a name="Controller.addLayout"></a>addLayout</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.addLayout = function addLayout(</td><td class=PParameter nowrap>layout</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote><p class=CParagraph>adds a layout layer to this this request</p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>layoutName</td><td class=CDLDescription>String.&nbsp; Layout name, or path relative to app/layouts</td></tr></table><h4 class=CHeading>Detail</h4><p class=CParagraph>Layouts are templates that wrap the content produced in a view.&nbsp; Layouts are stored in app/views/layouts/layoutName.ejs.&nbsp; Layouts are layered like so:</p><blockquote><pre class="CCode sh_myna">/app/views/layouts/default.ejs wraps<br>    /app/views/layouts/controllername/default.ejs wraps<br>        /app/views/controllername/actionname.ejs</pre></blockquote><h4 class=CHeading>Calling this function adds additional layouts that wrap the view, like so</h4><blockquote><pre class="CCode sh_myna">    function init(){<br>        this.addLayout(&quot;mylayout1&quot;)<br>        this.addLayout(&quot;otherController/mylayout2.ejs&quot;)<br>    }<br><br>//results in<br>/app/views/layouts/default.ejs wraps<br>    /app/views/layouts/controllername/default.ejs wraps<br>        /app/views/layouts/mylayout1.ejs wraps<br>            /app/views/layouts/otherController/mylayout2.ejs wraps<br>                /app/views/controllername/actionname.ejs</pre></blockquote></div></div>

<div class="CFunction CTopic"><h3 class=CTitle><a name="Controller.setLayout"></a>setLayout</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.setLayout = function setLayout(</td><td class=PParameter nowrap>layout</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote><p class=CParagraph>Sets a single layout layer to this this request, clearing any existing layouts</p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>layout</td><td class=CDLDescription>String or Boolean.&nbsp; Layout name, or path relative to app/layouts, or false to disable all layouts</td></tr></table><h4 class=CHeading>Detail</h4><p class=CParagraph>Layouts are templates that wrap the content produced in a view.&nbsp; Layouts are stored in app/views/layouts/layoutName.ejs.&nbsp; Layouts are layered like so:</p><blockquote><pre class="CCode sh_myna">/app/views/layouts/default.ejs wraps<br>    /app/views/layouts/controllername/default.ejs wraps<br>        /app/views/controllername/actionname.ejs</pre></blockquote><h4 class=CHeading>Calling this function adds a single additional layout that wrap the view, like so</h4><blockquote><pre class="CCode sh_myna">    function init(){<br>        this.setLayout(&quot;mylayout1&quot;)<br>    }<br><br>//results in<br>/app/views/layouts/default.ejs wraps<br>    /app/views/layouts/controllername/default.ejs wraps<br>        /app/views/layouts/mylayout1.ejs wraps<br>            /app/views/controllername/actionname.ejs</pre></blockquote></div></div>

<div class="CFunction CTopic"><h3 class=CTitle><a name="Controller.addFilter"></a>addFilter</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.addFilter = function addFilter(</td><td class=PParameter nowrap>filter,</td></tr><tr><td></td><td class=PParameter nowrap>options</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote><p class=CParagraph>adds an action filter</p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>filter</td><td class=CDLDescription>Function or Array.&nbsp; Filter function to execute, or Array of filter functions to execute.&nbsp; See <b>Filter Function Parameters</b> below</td></tr><tr><td class=CDLEntry>options</td><td class=CDLDescription><b>Optional, default see below</b> JS struct, see <b>Options:</b> below</td></tr></table><h4 class=CHeading>Options</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>when</td><td class=CDLDescription><b>Optional, default &ldquo;beforeAction&rdquo;</b> When the filter should be run. see <b>Events</b> below</td></tr><tr><td class=CDLEntry>only</td><td class=CDLDescription><b>Optional, default null</b> Array of String/RegExp.&nbsp; If defined, limit this filter to these action names.&nbsp; Mutually exclusive with <u>except</u></td></tr><tr><td class=CDLEntry>except</td><td class=CDLDescription><b>Optional, default null</b> Array String/RegExp.&nbsp; If defined, exclude this filter from these action names.&nbsp; Mutually exclusive with <u>only</u></td></tr></table><h4 class=CHeading>Filter Function Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>controller</td><td class=CDLDescription>Object reference to the controller to which this filer is applied</td></tr><tr><td class=CDLEntry>action</td><td class=CDLDescription>String name of action requested</td></tr><tr><td class=CDLEntry>params</td><td class=CDLDescription>the &ldquo;params&rdquo; argument passed to the action</td></tr><tr><td class=CDLEntry>response</td><td class=CDLDescription>The return from the action.&nbsp; This is always null for &ldquo;beforeAction&rdquo; filters</td></tr></table><h4 class=CHeading>Events</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>beforeAction</td><td class=CDLDescription>fired before executing an action function.&nbsp; Return false to cancel execution, return a JS object to supply new &ldquo;params&rdquo; to the action.&nbsp; Normally used to alter params or cancel routing. such as for authentication</td></tr><tr><td class=CDLEntry>afterAction</td><td class=CDLDescription>Fired after the action is complete but before default rendering.&nbsp; If the action contains an explicit <a href="#Controller.render" class=LFunction id=link11 onMouseOver="ShowTip(event, 'tt9', 'link11')" onMouseOut="HideTip('tt9')">render</a> or <a href="#Controller.renderContent" class=LFunction id=link12 onMouseOver="ShowTip(event, 'tt10', 'link12')" onMouseOut="HideTip('tt10')">renderContent</a> call then that will be executed first, without triggering &ldquo;beforeRender&rdquo; or &ldquo;afterRender&rdquo;.&nbsp; Return false or make a call to <a href="#Controller.render" class=LFunction id=link13 onMouseOver="ShowTip(event, 'tt9', 'link13')" onMouseOut="HideTip('tt9')">render</a> or <a href="#Controller.renderContent" class=LFunction id=link14 onMouseOver="ShowTip(event, 'tt10', 'link14')" onMouseOut="HideTip('tt10')">renderContent</a> to cancel the default render.&nbsp; Normally used for altering/adding properties to controller.data prior to rendering.&nbsp; Might also be used for custom rendering, but &ldquo;beforeRender&rdquo; is generally a better choice for that.</td></tr><tr><td class=CDLEntry>beforeRender</td><td class=CDLDescription>Fired before rendering the default view.&nbsp; Return false or make a call to <a href="#Controller.render" class=LFunction id=link15 onMouseOver="ShowTip(event, 'tt9', 'link15')" onMouseOut="HideTip('tt9')">render</a> or <a href="#Controller.renderContent" class=LFunction id=link16 onMouseOver="ShowTip(event, 'tt10', 'link16')" onMouseOut="HideTip('tt10')">renderContent</a> to cancel the default render.&nbsp; Normally used for custom renders that replace the default, such as rendering as RSS, or returning JSON</td></tr><tr><td class=CDLEntry>afterRender</td><td class=CDLDescription>Fired after the default render.&nbsp; Any changes to output should be made through <a href="../files/standard_objects/res-sjs.html#$res.clear" class=LFunction id=link17 onMouseOver="ShowTip(event, 'tt11', 'link17')" onMouseOut="HideTip('tt11')">$res.clear</a>, <a href="../files/standard_objects/res-sjs.html#$res.getContent" class=LFunction id=link18 onMouseOver="ShowTip(event, 'tt12', 'link18')" onMouseOut="HideTip('tt12')">$res.getContent</a>, <a href="../files/standard_objects/res-sjs.html#$res.print" class=LFunction id=link19 onMouseOver="ShowTip(event, 'tt13', 'link19')" onMouseOut="HideTip('tt13')">$res.print</a>, etc.&nbsp; Normally used to convert generated output such as converting to PDF or XHTML</td></tr></table><h4 class=CHeading>Detail</h4><p class=CParagraph>Filters are function run before or after actions and rendering for actions.&nbsp; Filters, by default, are run before every action, but can be applied to only specific actions.&nbsp; Great uses of filters are authentication and logging.&nbsp; Filters are only executed in &lt;handleAction&gt;, such as calls from web requests or <a href="#Controller.include" class=LFunction id=link20 onMouseOver="ShowTip(event, 'tt8', 'link20')" onMouseOut="HideTip('tt8')">include</a>, vs.&nbsp; &lt;call&gt; or direct execution from another action.</p><h4 class=CHeading>Examples</h4><blockquote><pre class="CCode sh_myna">function init(){<br>    // exec an auth function before every action except<br>    // &quot;home&quot; and &quot;status&quot;<br>    this.addFilter(<br>        this._auth,<br>        {<br>            except:[&quot;home&quot;,&quot;status&quot;]<br>        }<br>    )<br><br>    //log only actions whose name starts with &quot;save&quot;<br>    this.addFilter(<br>        this._audit,<br>        {<br>            only:[/^save/i]<br>        }<br>    )<br><br>    this.addFilter(<br>        this._pdfView,<br>        {<br>            when:&quot;afterRender&quot;<br>        }<br>    )<br><br>}<br><br><br>//Functions that begin with &quot;_&quot; are excluded from browser requests<br>function _auth(controller,action,params){<br>    if (!$cookie.getAuthUser()){<br>        $FP.redirectTo({<br>            controller:&quot;Auth&quot;,<br>            action:&quot;login&quot;<br>        })<br>        //unnecessary, but good practice<br>        return false; //cancels actino<br>    }<br>}<br><br>function _audit(controller,action,params){<br>    Myna.log(<br>        &quot;audit&quot;,<br>        controller.name + &quot;.&quot; + action,<br>        Myna.dump({<br>            params:params,<br>            user:$cookie.getAuthUser()<br>        })<br>    );<br>}<br><br>function _pdfView(controller, action, params){<br>    if (params.format ==&quot;pdf&quot;){<br>        this.renderContent(<br>            Myna.xmlToPdf(<br>                Myna.htmlToXhtml(<br>                    $res.clear()<br>                )<br>            ),<br>            &quot;application/pdf&quot;,<br>            params.controller + &quot;.&quot; + params.action + &quot;.pdf&quot;<br>        );<br>    }<br>}</pre></blockquote></div></div>

<div class="CFunction CTopic"><h3 class=CTitle><a name="Controller.applyBehavior"></a>applyBehavior</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.applyBehavior = function applyBehavior(</td><td class=PParameter nowrap>name,</td></tr><tr><td></td><td class=PParameter nowrap>options</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote><p class=CParagraph>loads a behavior and applies it to this object</p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>name</td><td class=CDLDescription>The ProperCased name of the behavior to load, or an array of these names,</td></tr><tr><td class=CDLEntry>options</td><td class=CDLDescription><b>Optional, defaul null</b> JS Object containing options to pass to the behavior&rsquo;s init function</td></tr></table><h4 class=CHeading>Detail</h4><p class=CParagraph>Loads a behavior by name from app/behaviors/controllers/ or framework/behaviors/controllers/, whichever is found first.&nbsp; Behaviors are functions that are applied to the current object.&nbsp; <a href="#Controller.applyBehavior" class=LFunction id=link21 onMouseOver="ShowTip(event, 'tt4', 'link21')" onMouseOut="HideTip('tt4')">applyBehavior</a> should be called from &lt;init&gt;</p><h4 class=CHeading>Example</h4><blockquote><pre class="CCode sh_myna">//in some_controller.sjs<br>function init(){<br>    // loads the built-in PDF andJSON filters<br>    // Each of these has an &quot;init&quot; function that adds the appropriate<br>    // before and after filters<br>    this.applyBehavior([<br>        &quot;FormatPdf&quot;,<br>        &quot;FormatJson&quot;<br>    ]);<br><br>    //loads a single behavior with options<br>    this.applyBehavior(&quot;MynaAuth&quot;,{<br>        whitelist:[<br>            &quot;Main.index&quot;,<br>            &quot;Main.logout&quot;<br>        ],<br>        redirectParams:{<br>            message: &quot;Enter your AD domain credentials&quot;,<br>            providers:[&quot;ldap_ad&quot;]<br>        }<br>    });<br>}</pre></blockquote></div></div>

<div class="CFunction CTopic"><h3 class=CTitle><a name="Controller.getFilters"></a>getFilters</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.getFilters = function addFilter(</td><td class=PParameter nowrap>event,</td></tr><tr><td></td><td class=PParameter nowrap>action</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote><p class=CParagraph>returns the filter array for the requested event and action.</p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>event</td><td class=CDLDescription>event name</td></tr><tr><td class=CDLEntry>action</td><td class=CDLDescription>action name</td></tr></table><h4 class=CHeading>See</h4><ul class=CBulletList><li><a href="#Controller.addFilter" class=LFunction id=link22 onMouseOver="ShowTip(event, 'tt3', 'link22')" onMouseOut="HideTip('tt3')">addFilter</a></li></ul></div></div>

<div class="CFunction CTopic"><h3 class=CTitle><a name="Controller.getActions"></a>getActions</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>Controller.prototype.getActions = function getActions()</td></tr></table></blockquote><p class=CParagraph>returns an array of objects for each action that contain the action name and action function.</p><h4 class=CHeading>Object Properties</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>action</td><td class=CDLDescription>String action name</td></tr><tr><td class=CDLEntry>handler</td><td class=CDLDescription>Function reference to action function</td></tr></table></div></div>

<div class="CFunction CTopic"><h3 class=CTitle><a name="Controller.callAction"></a>callAction</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.callAction = function callAction(</td><td class=PParameter nowrap>action,</td></tr><tr><td></td><td class=PParameter nowrap>params</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote><p class=CParagraph>Call an action as an inline function.</p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>action</td><td class=CDLDescription>action name to execute</td></tr><tr><td class=CDLEntry>params</td><td class=CDLDescription><b>Optional, default {}</b> params to pass to the action</td></tr></table><h4 class=CHeading>Detail</h4><p class=CParagraph>Calling this function on a controller will execute the specified action &ldquo;inline&rdquo;, meaning without generating output, and will return whatever the action returns.&nbsp; Before and after action filters are also triggered.&nbsp; This can be useful for marshaling several actions in one request, or for providing alternate ways of calling actions (see &lt;framework.controllers.DirectController&gt;)</p><h4 class=CHeading>Example</h4><blockquote><pre class="CCode sh_myna">//triggers filters, so will fail if cur user is not authorized<br>var empList = $FP.getController(&quot;employee&quot;).callAction(&quot;list&quot;,params);</pre></blockquote><h4 class=CHeading>Note</h4><p class=CParagraph>You can also call actions directly from a controller, but filters won&rsquo;t be triggered.</p><blockquote><pre class="CCode sh_myna">// does not run filters, but might render output if render() or<br>// renderContent() is called inside this action<br>var empList = $FP.getController(&quot;employee&quot;).list(params);</pre></blockquote></div></div>

<div class="CFunction CTopic"><h3 class=CTitle><a name="Controller.include"></a>include</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.include = function include(</td><td class=PParameter nowrap>action,</td></tr><tr><td></td><td class=PParameter nowrap>params</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote><p class=CParagraph>Call an action and includes its output in the current request</p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>action</td><td class=CDLDescription>action name to execute</td></tr><tr><td class=CDLEntry>params</td><td class=CDLDescription><b>Optional, default {}</b> params to pass to the action</td></tr></table><h4 class=CHeading>Detail</h4><p class=CParagraph>Calling this function on a controller will execute the specified action &ldquo;inline&rdquo;, meaning without generating output, and will return whatever the action returns.&nbsp; Before and after action filters are also triggered.&nbsp; This can be useful for marshaling several actions in one request, or for providing alternate ways of calling actions (see &lt;framework.controllers.DirectController&gt;)</p><h4 class=CHeading>Example</h4><blockquote><pre class="CCode sh_myna">//triggers filters, so will fail if cur user is not authorized<br>var empList = $FP.getController(&quot;employee&quot;).callAction(&quot;list&quot;,params);</pre></blockquote></div></div>

<div class="CFunction CTopic"><h3 class=CTitle><a name="Controller.render"></a>render</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.render = function render(</td><td class=PParameter nowrap>options</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote><p class=CParagraph>renders a view</p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>options</td><td class=CDLDescription><b>Optional</b> String or Object or null.&nbsp; If a string, the filename of the view in app/views to load, minus the extension.&nbsp; If this is null, then rendering is canceled.&nbsp; If this is an object or undefined, see <b>Options:</b> below</td></tr></table><h4 class=CHeading>Options</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>controller</td><td class=CDLDescription><b>Optional, default current controller</b> ProperCased controller folder within app/views to reference.&nbsp; This will be converted to file format automatically</td></tr><tr><td class=CDLEntry>action</td><td class=CDLDescription><b>Optional, default current action</b> camelCased action name.&nbsp; This will be converted to file format automatically</td></tr></table><h4 class=CHeading>Detail</h4><p class=CParagraph>This function is called automatically with default <u>options</u> whenever an action function returns.&nbsp; This function can be called explicitly from inside an action function to override this default behavior</p><p class=CParagraph>When rendering a view, all previously generated content is cleared, and the view is included.&nbsp; Once the view is rendered, it is wrapped in any defined layouts (see &lt;addLayout&gt;)  The following variables are available in view scope, and can be directly referenced:</p><ul class=CBulletList><li>Myna functions, i.e. createUuid() instead of Myna.createUuid(),</li><li>$FP properties, all $FP functions and properties can be directly referenced</li><li>$controller, a reference to the controller that called this view</li><li>$helpers, a reference to $FP.helpers</li><li>$page, a reference to this controller&rsquo;s <a href="#Controller.$page" class=LProperty id=link23 onMouseOver="ShowTip(event, 'tt14', 'link23')" onMouseOut="HideTip('tt14')">$page</a> property</li><li>renderElement a reference to &lt;renderElement&gt;</li><li>This controller&rsquo;s &lt;data&gt; properties</li></ul><h4 class=CHeading>Examples</h4><blockquote><pre class="CCode sh_myna">//in app/controllers/person_controller.sjs<br>function doStuff(params){<br>    //bulk sets/replaces this.data<br>    this.set({<br>        firstName:&quot;Bob&quot;,<br>        lastName:&quot;Dobb&quot;<br>    })<br><br>    //sets an individual property<br>    this.set(&quot;bean&quot;,this.Person.get({id:params.id}))<br><br>    // implied render, same as<br>    // this.render({controller:this.name,action:&quot;doStuff&quot;})<br>}<br><br>//in app/viwes/person/do_stuff.ejs<br>&lt;form action=&quot;&lt;%=$helpers.Html.url({action:&quot;save&quot;,id:bean.id})%&gt;&quot; method=&quot;post&quot;&gt;<br>&lt;table width=&quot;100%&quot; height=&quot;1&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; border=&quot;0&quot; &gt;<br>    &lt;tr&gt;<br>        &lt;th class=&quot;&quot;&gt;ID:&lt;/th&gt;&lt;td&gt;&lt;%=bean.id%&gt;&lt;td&gt;<br>    &lt;/tr&gt;<br><br>    &lt;tr&gt;<br>        &lt;th&gt;&lt;%=bean.getLabel(&quot;first_name&quot;)%&gt;:&lt;/th&gt;<br>        &lt;td&gt;&lt;input name=&quot;first_name&quot; value=&quot;&lt;%=String(bean.data.first_name||&quot;&quot;).escapeHtml()%&gt;&quot;&gt;&lt;td&gt;<br>    &lt;/tr&gt;<br>    &lt;tr&gt;<br>        &lt;th&gt;&lt;%=bean.getLabel(&quot;last_name&quot;)%&gt;:&lt;/th&gt;<br>        &lt;td&gt;&lt;input name=&quot;last_name&quot; value=&quot;&lt;%=String(bean.data.last_name||&quot;&quot;).escapeHtml()%&gt;&quot;&gt;&lt;td&gt;<br>    &lt;/tr&gt;<br><br>    &lt;tr&gt;<br>        &lt;td colspan=&quot;2&quot; align=&quot;right&quot;&gt;<br>            &lt;button type=&quot;submit&quot;&gt;Save&lt;/button&gt;<br>        &lt;/td&gt;<br>    &lt;/tr&gt;<br>&lt;/table&gt;<br>&lt;/form&gt;</pre></blockquote></div></div>

<div class="CFunction CTopic"><h3 class=CTitle><a name="Controller.renderContent"></a>renderContent</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.renderContent = function renderBinary(</td><td class=PParameter nowrap>data,</td></tr><tr><td></td><td class=PParameter nowrap>contentType,</td></tr><tr><td></td><td class=PParameter nowrap>filename</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote><p class=CParagraph>Directly render content, bypassing default render</p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>data</td><td class=CDLDescription>String content, or binary data from <a href="../files/File-sjs.html#Myna.File.readBinary" class=LFunction id=link24 onMouseOver="ShowTip(event, 'tt15', 'link24')" onMouseOut="HideTip('tt15')">Myna.File.readBinary</a> or from binary database query (byte [])</td></tr><tr><td class=CDLEntry>contentType</td><td class=CDLDescription><b>Optional, default text/html for strings and application/octet-stream for binary</b> MIME type of <u>content</u>.&nbsp; If &ldquo;&rdquo; or null, the default will be used</td></tr><tr><td class=CDLEntry>filename</td><td class=CDLDescription><b>Optional, default null</b> if defined, a &ldquo;Content-disposition&rdquo; response header is set to present the standard &ldquo;Save or Open?&rdquo; dialog to the client.&nbsp; Use this if offering a file for download, but not if you expect the content to be rendered inline</td></tr></table><h4 class=CHeading>See</h4><p class=CParagraph><a href="../files/standard_objects/res-sjs.html#$res.printBinary" class=LFunction id=link25 onMouseOver="ShowTip(event, 'tt16', 'link25')" onMouseOut="HideTip('tt16')">$res.printBinary</a></p></div></div>

</div><!--Content-->


<div id=Footer><a href="http://www.naturaldocs.org">Generated by Natural Docs</a></div><!--Footer-->


<div id=Menu><div id=MTitle>Myna Application Server<div id=MSubTitle>JavaScript documentation</div></div><div class="MGroup MEntry"><a href="javascript:ToggleMenu('MGroupContent1')">Misc Topics</a><div class=MGroupContent id=MGroupContent1><div class="MFile MEntry"><a href="../files/install-txt.html">Myna Commandline</a></div><div class="MFile MEntry"><a href="../files/MynaPath-txt.html">MynaPath</a></div><div class="MFile MEntry"><a href="../files/auth_adapters/auth_adapters-txt.html">AuthAdapters</a></div><div class="MFile MEntry"><a href="../files/auth_adapters/ldap-sjs.html">LDAP Auth Adapter</a></div><div class="MFile MEntry"><a href="../files/debug_window-js.html">debug_window.js</a></div><div class="MFile MEntry"><a href="../files/ObjectLib-js.html">ObjectLib</a></div></div></div><div class="MGroup MEntry"><a href="javascript:ToggleMenu('MGroupContent2')">JavaScript Global Objects</a><div class=MGroupContent id=MGroupContent2><div class="MFile MEntry"><a href="../files/Array-js.html">Array</a></div><div class="MFile MEntry"><a href="../files/Date-js.html">Date</a></div><div class="MFile MEntry"><a href="../files/Function-js.html">Function</a></div><div class="MFile MEntry"><a href="../files/Number-js.html">Number</a></div><div class="MFile MEntry"><a href="../files/Object-js.html">Object</a></div><div class="MFile MEntry"><a href="../files/String-js.html">String</a></div><div class="MFile MEntry"><a href="../files/E4X-js.html">XML</a></div></div></div><div class="MGroup MEntry"><a href="javascript:ToggleMenu('MGroupContent3')">Myna Global Objects</a><div class=MGroupContent id=MGroupContent3><div class="MFile MEntry"><a href="../files/standard_objects/app-sjs.html">$application</a></div><div class="MFile MEntry"><a href="../files/standard_objects/cookie-sjs.html">$cookie</a></div><div class="MFile MEntry"><a href="../files/standard_objects/profiler-sjs.html">$profiler</a></div><div class="MFile MEntry"><a href="../files/standard_objects/req-sjs.html">$req</a></div><div class="MFile MEntry"><a href="../files/standard_objects/res-sjs.html">$res</a></div><div class="MFile MEntry"><a href="../files/standard_objects/server-sjs.html">$server</a></div><div class="MFile MEntry"><a href="../files/standard_objects/session-sjs.html">$session</a></div></div></div><div class="MGroup MEntry"><a href="javascript:ToggleMenu('MGroupContent4')">Myna Object</a><div class=MGroupContent id=MGroupContent4><div class="MFile MEntry"><a href="../files/Async-js.html">Async</a></div><div class="MFile MEntry"><a href="../files/DataSet-js.html">DataSet</a></div><div class="MFile MEntry"><a href="../files/DataSet-sjs.html">DataSet.sjs</a></div><div class="MFile MEntry"><a href="../files/Myna-sjs.html">Myna</a></div><div class="MFile MEntry"><a href="../files/Admin-sjs.html">Myna.<span class=HB> </span>Admin</a></div><div class="MFile MEntry"><a href="../files/Cache-sjs.html">Myna.<span class=HB> </span>Cache</a></div><div class="MFile MEntry"><a href="../files/Cluster-sjs.html">Myna.<span class=HB> </span>Cluster</a></div><div class="MFile MEntry"><a href="../files/CommonJS-sjs.html">Myna.<span class=HB> </span>CommonJS</a></div><div class="MFile MEntry"><a href="../files/Database-sjs.html">Myna.<span class=HB> </span>Database</a></div><div class="MFile MEntry"><a href="../files/DataManager-sjs.html">Myna.<span class=HB> </span>DataManager</a></div><div class="MFile MEntry"><a href="../files/Event-sjs.html">Myna.<span class=HB> </span>Event</a></div><div class="MFile MEntry"><a href="../files/File-sjs.html">Myna.File</a></div><div class="MFile MEntry"><a href="../files/HttpConnection-sjs.html">Myna.<span class=HB> </span>HttpConnection</a></div><div class="MFile MEntry"><a href="../files/Inflector-js.html">Myna.<span class=HB> </span>Inflector</a></div><div class="MFile MEntry"><a href="../files/JavaUtils-sjs.html">Myna.<span class=HB> </span>JavaUtils</a></div><div class="MFile MEntry"><a href="../files/KeyStore-sjs.html">Myna.<span class=HB> </span>KeyStore</a></div><div class="MFile MEntry"><a href="../files/Ldap-sjs.html">Myna.Ldap</a></div><div class="MFile MEntry"><a href="../files/Mail-sjs.html">Myna.Mail</a></div><div class="MFile MEntry"><a href="../files/Permissions-sjs.html">Myna.<span class=HB> </span>Permissions</a></div><div class="MFile MEntry"><a href="../files/Profiler-js.html">Myna.<span class=HB> </span>Profiler</a></div><div class="MFile MEntry"><a href="../files/Query-sjs.html">Myna.<span class=HB> </span>Query</a></div><div class="MFile MEntry"><a href="../files/Swing-sjs.html">Myna.<span class=HB> </span>Swing</a></div><div class="MFile MEntry"><a href="../files/Table-sjs.html">Myna.<span class=HB> </span>Table</a></div><div class="MFile MEntry"><a href="../files/Template-sjs.html">Myna.<span class=HB> </span>Template</a></div><div class="MFile MEntry"><a href="../files/Thread-sjs.html">Myna.<span class=HB> </span>Thread</a></div><div class="MFile MEntry"><a href="../files/Validation-js.html">Myna.<span class=HB> </span>Validation</a></div><div class="MFile MEntry"><a href="../files/ValidationResult-js.html">Myna.<span class=HB> </span>ValidationResult</a></div><div class="MFile MEntry"><a href="../files/WebService-sjs.html">Myna.<span class=HB> </span>WebService</a></div></div></div><div class="MGroup MEntry"><a href="javascript:ToggleMenu('MGroupContent5')">Myna FlightPath</a><div class=MGroupContent id=MGroupContent5><div class="MFile MEntry"><a href="FlightPath-sjs.html">FlightPath</a></div><div class="MFile MEntry" id=MSelected>Controller</div><div class="MFile MEntry"><a href="Model-sjs.html">Model</a></div><div class="MFile MEntry"><a href="Flash-sjs.html">$flash</a></div><div class="MFile MEntry"><a href="helpers/Html-sjs.html">$helpers.Html</a></div><div class="MFile MEntry"><a href="controllers/direct_controller-sjs.html">framework.<span class=HB> </span>controllers.<span class=HB> </span>DirectController</a></div></div></div><div class="MGroup MEntry"><a href="javascript:ToggleMenu('MGroupContent6')">Index</a><div class=MGroupContent id=MGroupContent6><div class="MIndex MEntry"><a href="../index/General.html">Everything</a></div><div class="MIndex MEntry"><a href="../index/GlobalVariables.html">Global Variables</a></div><div class="MIndex MEntry"><a href="../index/Classes.html">Classes</a></div><div class="MIndex MEntry"><a href="../index/Functions.html">Functions</a></div><div class="MIndex MEntry"><a href="../index/Files.html">Files</a></div><div class="MIndex MEntry"><a href="../index/Properties.html">Properties</a></div></div></div><script type="text/javascript"><!--
var searchPanel = new SearchPanel("searchPanel", "HTML", "../search");
--></script><div id=MSearchPanel class=MSearchPanelInactive><input type=text id=MSearchField value=Search onFocus="searchPanel.OnSearchFieldFocus(true)" onBlur="searchPanel.OnSearchFieldFocus(false)" onKeyUp="searchPanel.OnSearchFieldChange()"><select id=MSearchType onFocus="searchPanel.OnSearchTypeFocus(true)" onBlur="searchPanel.OnSearchTypeFocus(false)" onChange="searchPanel.OnSearchTypeChange()"><option  id=MSearchEverything selected value="General">Everything</option><option value="Classes">Classes</option><option value="Files">Files</option><option value="Functions">Functions</option><option value="GlobalVariables">Global Variables</option><option value="Properties">Properties</option></select></div><div id=MSearchResultsWindow><iframe src="" frameborder=0 name=MSearchResults id=MSearchResults></iframe><a href="javascript:searchPanel.CloseResultsWindow()" id=MSearchResultsWindowClose>Close</a></div><script language=JavaScript><!--
if (document.getElementById){for (var menu = 1; menu < 7; menu++){if (menu != 5 && menu != 6){document.getElementById("MGroupContent" + menu).style.display = "block";};};}// --></script></div><!--Menu-->



<!--START_ND_TOOLTIPS-->
<div class=CToolTip id="tt1"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.addLayout = function addLayout(</td><td class=PParameter nowrap>layout</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>adds a layout layer to this this request</div></div><div class=CToolTip id="tt2"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.setLayout = function setLayout(</td><td class=PParameter nowrap>layout</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>Sets a single layout layer to this this request, clearing any existing layouts</div></div><div class=CToolTip id="tt3"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.addFilter = function addFilter(</td><td class=PParameter nowrap>filter,</td></tr><tr><td></td><td class=PParameter nowrap>options</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>adds an action filter</div></div><div class=CToolTip id="tt4"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.applyBehavior = function applyBehavior(</td><td class=PParameter nowrap>name,</td></tr><tr><td></td><td class=PParameter nowrap>options</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>loads a behavior and applies it to this object</div></div><div class=CToolTip id="tt5"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.getFilters = function addFilter(</td><td class=PParameter nowrap>event,</td></tr><tr><td></td><td class=PParameter nowrap>action</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>returns the filter array for the requested event and action.</div></div><div class=CToolTip id="tt6"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>Controller.prototype.getActions = function getActions()</td></tr></table></blockquote>returns an array of objects for each action that contain the action name and action function.</div></div><div class=CToolTip id="tt7"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.callAction = function callAction(</td><td class=PParameter nowrap>action,</td></tr><tr><td></td><td class=PParameter nowrap>params</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>Call an action as an inline function.</div></div><div class=CToolTip id="tt8"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.include = function include(</td><td class=PParameter nowrap>action,</td></tr><tr><td></td><td class=PParameter nowrap>params</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>Call an action and includes its output in the current request</div></div><div class=CToolTip id="tt9"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.render = function render(</td><td class=PParameter nowrap>options</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>renders a view</div></div><div class=CToolTip id="tt10"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.renderContent = function renderBinary(</td><td class=PParameter nowrap>data,</td></tr><tr><td></td><td class=PParameter nowrap>contentType,</td></tr><tr><td></td><td class=PParameter nowrap>filename</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>Directly render content, bypassing default render</div></div><div class=CToolTip id="tt11"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>clear:function ()</td></tr></table></blockquote>Clears response buffer and returns the previous contents.</div></div><div class=CToolTip id="tt12"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>getContent:function ()</td></tr></table></blockquote>Returns current response buffer contents.</div></div><div class=CToolTip id="tt13"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>print:function (</td><td class=PParameter nowrap>text</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>Appends content to the response buffer.</div></div><div class=CToolTip id="tt14"><div class=CProperty>$page metadata object</div></div><div class=CToolTip id="tt15"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>Myna.File.prototype.readBinary = function()</td></tr></table></blockquote>returns the contents of this file as a java byte[] array</div></div><div class=CToolTip id="tt16"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>printBinary:function(</td><td class=PParameter nowrap>data,</td></tr><tr><td></td><td class=PParameter nowrap>contentType,</td></tr><tr><td></td><td class=PParameter nowrap>filename</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>sends binary data to the browser</div></div><!--END_ND_TOOLTIPS-->




<script language=JavaScript><!--
if (browserType) {if (browserVer) {document.write("</div>"); }document.write("</div>");}// --></script></body></html>