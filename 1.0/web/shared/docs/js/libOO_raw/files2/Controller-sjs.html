<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">

<html><head><title>Controller - Myna Application Server</title><link rel="stylesheet" type="text/css" href="../styles/main.css"><script language=JavaScript src="../javascript/main.js"></script><script language=JavaScript src="../javascript/searchdata.js"></script><script type="text/javascript" src="../../../../js/shjs/sh_main.js"></script><script type="text/javascript" src="../../../../js/shjs/lang/sh_myna.js"></script><link type="text/css" rel="stylesheet" href="../../../../js/shjs/css/sh_mild_white.css"><script type="text/javascript" src="../../../../../js/shjs/sh_main.js"></script><script type="text/javascript" src="../../../../../js/shjs/lang/sh_myna.js"></script><link type="text/css" rel="stylesheet" href="../../../../../js/shjs/css/sh_mild_white.css"></head><body id=ContentPage onLoad="NDOnLoad();sh_highlightDocument();"><script language=JavaScript><!--
if (browserType) {document.write("<div id=" + browserType + ">");if (browserVer) {document.write("<div id=" + browserVer + ">"); }}// --></script>

<!--  Generated by Natural Docs, version Development Release 02-10-2007 (1.35 base) -->
<!--  http://www.naturaldocs.org  -->

<!-- saved from url=(0026)http://www.naturaldocs.org -->




<div id=Content><div class="CClass CTopic" id=MainTopic><h1 class=CTitle><a name="Controller"></a>Controller</h1><div class=CBody><p class=CParagraph>In FlightPath, controllers (the C in MVC) are represented by the Controller class.&nbsp; See <a href="#Controller.Overview" class=LGeneric id=link15 onMouseOver="ShowTip(event, 'tt15', 'link15')" onMouseOut="HideTip('tt15')">Overview</a></p><!--START_ND_SUMMARY--><div class=Summary><div class=STitle>Summary</div><div class=SBody><table border=0 cellspacing=0 cellpadding=0 class=STable><tr class="SMain"><td class=SEntry><a href="#Controller" >Controller</a></td><td class=SDescription>In FlightPath, controllers (the C in MVC) are represented by the Controller class. </td></tr><tr class="SGeneric SIndent1 SMarked"><td class=SEntry><a href="#Controller.Overview" >Overview</a></td><td class=SDescription>In FlightPath, controllers (the C in MVC) are represented by the Controller class.</td></tr><tr class="SGeneric SIndent1"><td class=SEntry><a href="#Controller.Conventions" >Conventions</a></td><td class=SDescription></td></tr><tr class="SGeneric SIndent1 SMarked"><td class=SEntry><a href="#Controller.Defining_Controllers" >Defining Controllers</a></td><td class=SDescription>Controller definitions can be stored in app/controllers/&lt;controller_name&gt;_controller.sjs or in a module:app/modules/module_name/controllers/&lt;controller_name&gt;_controller.sjs. </td></tr><tr class="SGroup SIndent1"><td class=SEntry><a href="#Controller.Properties" >Properties</a></td><td class=SDescription></td></tr><tr class="SProperty SIndent2 SMarked"><td class=SEntry><a href="#Controller.$page" >$page</a></td><td class=SDescription>$page metadata object</td></tr><tr class="SProperty SIndent2"><td class=SEntry><a href="#Controller.data" >data</a></td><td class=SDescription>local request-specific data to be passed to views</td></tr><tr class="SProperty SIndent2 SMarked"><td class=SEntry><a href="#Controller.name" >name</a></td><td class=SDescription>The name of this controller</td></tr><tr class="SGroup SIndent1"><td class=SEntry><a href="#Controller.Functions" >Functions</a></td><td class=SDescription></td></tr><tr class="SFunction SIndent2 SMarked"><td class=SEntry><a href="#Controller.addLayout" id=link1 onMouseOver="ShowTip(event, 'tt1', 'link1')" onMouseOut="HideTip('tt1')">addLayout</a></td><td class=SDescription>adds a layout layer to this this request</td></tr><tr class="SFunction SIndent2"><td class=SEntry><a href="#Controller.setLayout" id=link2 onMouseOver="ShowTip(event, 'tt2', 'link2')" onMouseOut="HideTip('tt2')">setLayout</a></td><td class=SDescription>Sets a single layout layer to this this request, clearing any existing layouts</td></tr><tr class="SFunction SIndent2 SMarked"><td class=SEntry><a href="#Controller.addFilter" id=link3 onMouseOver="ShowTip(event, 'tt3', 'link3')" onMouseOut="HideTip('tt3')">addFilter</a></td><td class=SDescription>Adds an action filter</td></tr><tr class="SFunction SIndent2"><td class=SEntry><a href="#Controller.applyBehavior" id=link4 onMouseOver="ShowTip(event, 'tt4', 'link4')" onMouseOut="HideTip('tt4')">applyBehavior</a></td><td class=SDescription>loads a behavior and applies it to this object</td></tr><tr class="SFunction SIndent2 SMarked"><td class=SEntry><a href="#Controller.getFilters" id=link5 onMouseOver="ShowTip(event, 'tt5', 'link5')" onMouseOut="HideTip('tt5')">getFilters</a></td><td class=SDescription>returns the filter array for the requested event and action.</td></tr><tr class="SFunction SIndent2"><td class=SEntry><a href="#Controller.getActions" id=link6 onMouseOver="ShowTip(event, 'tt6', 'link6')" onMouseOut="HideTip('tt6')">getActions</a></td><td class=SDescription>returns an array of objects for each action that contain the action name and action function.</td></tr><tr class="SFunction SIndent2 SMarked"><td class=SEntry><a href="#Controller.callAction" id=link7 onMouseOver="ShowTip(event, 'tt7', 'link7')" onMouseOut="HideTip('tt7')">callAction</a></td><td class=SDescription>Call an action as an inline function.</td></tr><tr class="SFunction SIndent2"><td class=SEntry><a href="#Controller.include" id=link8 onMouseOver="ShowTip(event, 'tt8', 'link8')" onMouseOut="HideTip('tt8')">include</a></td><td class=SDescription>Call an action and includes its output in the current request</td></tr><tr class="SFunction SIndent2 SMarked"><td class=SEntry><a href="#Controller.init" id=link9 onMouseOver="ShowTip(event, 'tt9', 'link9')" onMouseOut="HideTip('tt9')">init</a></td><td class=SDescription>Initializes a controller instance</td></tr><tr class="SFunction SIndent2"><td class=SEntry><a href="#Controller.render" id=link10 onMouseOver="ShowTip(event, 'tt10', 'link10')" onMouseOut="HideTip('tt10')">render</a></td><td class=SDescription>renders a view</td></tr><tr class="SFunction SIndent2 SMarked"><td class=SEntry><a href="#Controller.renderContent" id=link11 onMouseOver="ShowTip(event, 'tt11', 'link11')" onMouseOut="HideTip('tt11')">renderContent</a></td><td class=SDescription>Directly render content, bypassing default render</td></tr><tr class="SFunction SIndent2"><td class=SEntry><a href="#Controller.getElement" id=link12 onMouseOver="ShowTip(event, 'tt12', 'link12')" onMouseOut="HideTip('tt12')">getElement</a></td><td class=SDescription>renders an HTML template returns the content as a string</td></tr><tr class="SFunction SIndent2 SMarked"><td class=SEntry><a href="#Controller.set" id=link13 onMouseOver="ShowTip(event, 'tt13', 'link13')" onMouseOut="HideTip('tt13')">set</a></td><td class=SDescription>Sets a property on <a href="#Controller.data" class=LProperty id=link14 onMouseOver="ShowTip(event, 'tt14', 'link14')" onMouseOut="HideTip('tt14')">data</a></td></tr></table></div></div><!--END_ND_SUMMARY--></div></div>

<div class="CGeneric CTopic"><h3 class=CTitle><a name="Controller.Overview"></a>Overview</h3><div class=CBody><p class=CParagraph>In FlightPath, controllers (the C in MVC) are represented by the Controller class.</p><p class=CParagraph>Controllers are responsible for connecting requests to <a href="Model-sjs.html#Model" class=LClass id=link16 onMouseOver="ShowTip(event, 'tt16', 'link16')" onMouseOut="HideTip('tt16')">Models</a> and <a href="FlightPath-txt.html#Views" class=LGeneric id=link17 onMouseOver="ShowTip(event, 'tt17', 'link17')" onMouseOut="HideTip('tt17')">Views</a> The consist of one or more <u>actions</u>: functions that take parameters from the route, perform any necessary business logic with <a href="Model-sjs.html#Model" class=LClass id=link18 onMouseOver="ShowTip(event, 'tt16', 'link18')" onMouseOut="HideTip('tt16')">Models</a> and render a response, typically with <a href="FlightPath-txt.html#Views" class=LGeneric id=link19 onMouseOver="ShowTip(event, 'tt17', 'link19')" onMouseOut="HideTip('tt17')">Views</a></p><h4 class=CHeading>How to load a controller</h4><p class=CParagraph>Controllers are normally loaded via a route (See: <a href="FlightPath-txt.html#Routes" class=LGeneric id=link20 onMouseOver="ShowTip(event, 'tt18', 'link20')" onMouseOut="HideTip('tt18')">Routes</a>), but they can also be accessed via <a href="FlightPath-sjs.html#$FP.getController" class=LFunction id=link21 onMouseOver="ShowTip(event, 'tt19', 'link21')" onMouseOut="HideTip('tt19')">$FP.getController</a>.</p><h4 class=CHeading>See</h4><ul class=CBulletList><li><a href="#Controller.Conventions" class=LGeneric >Conventions</a></li><li><a href="#Controller.Defining_Controllers" class=LGeneric id=link22 onMouseOver="ShowTip(event, 'tt20', 'link22')" onMouseOut="HideTip('tt20')">Defining Controllers</a></li><li><a href="FlightPath-txt.html#FlightPath_Overview" class=LGeneric id=link23 onMouseOver="ShowTip(event, 'tt21', 'link23')" onMouseOut="HideTip('tt21')">FlightPath Overview</a></li></ul></div></div>

<div class="CGeneric CTopic"><h3 class=CTitle><a name="Controller.Conventions"></a>Conventions</h3><div class=CBody><ul class=CBulletList><li>Controller Names are singular, ProperCase, ex: EmployeeAction</li><li>Controller File names are in file_case, ending with &ldquo;_controller&rdquo;, ex: app/controllers/employee_action_controller.sjs</li><li>Controller definitions are discovered in this order: framework/controllers/&lt;controller_name&gt;_controller.sjs, app/controllers/&lt;controller_name&gt;.sjs, app/modules/&lt;module_name&gt;/controllers/&lt;controller_name&gt;_controller.sjs</li><li>The ini() and functions in app/controllers/global.sjs are applied before any controller definitions discovered</li><li>Actions are functions defined in the Controller definition file.</li><li>init() and any functions starting with &ldquo;_&rdquo; are not considered Actions, and cannot be called from <a href="FlightPath-txt.html#Routes" class=LGeneric id=link24 onMouseOver="ShowTip(event, 'tt18', 'link24')" onMouseOut="HideTip('tt18')">Routes</a></li><li>Action names are camelCase, ex: changeStartDate()</li><li>Actions and are typically verbs that might be applied to the controller, e.g.EmployeeAction.edit() rather than EmployeeAction.editAction()</li><li>in URLs, controller and action names are in url-case, e.g. employee_action/edit/15 or employee-action/edit/15</li><li>The default route for FlightPath will connect a URL of employee_action/edit/15 to EmployeeAction.edit({id:15})</li><li>Controllers will look for a <a href="Model-sjs.html#Model" class=LClass id=link25 onMouseOver="ShowTip(event, 'tt16', 'link25')" onMouseOut="HideTip('tt16')">Model</a> with the same name as the controller, and store a reference to it in this.model and this.&lt;ModelName&gt;</li><li>After executing an Action, Controllers will automatically load the View with the same name as the action, ex: EmployeeAction.edit() will render app/views/employee_action/edit.ejs</li><li>Calling <a href="#Controller.render" class=LFunction id=link26 onMouseOver="ShowTip(event, 'tt10', 'link26')" onMouseOut="HideTip('tt10')">render</a> or <a href="#Controller.renderContent" class=LFunction id=link27 onMouseOver="ShowTip(event, 'tt11', 'link27')" onMouseOut="HideTip('tt11')">renderContent</a> will cancel default view rendering</li><li>Any data inteded to be rendered should be passed to the via via <a href="#Controller.data" class=LProperty id=link28 onMouseOver="ShowTip(event, 'tt14', 'link28')" onMouseOut="HideTip('tt14')">data</a> or <a href="#Controller.set" class=LFunction id=link29 onMouseOver="ShowTip(event, 'tt13', 'link29')" onMouseOut="HideTip('tt13')">set</a></li></ul></div></div>

<div class="CGeneric CTopic"><h3 class=CTitle><a name="Controller.Defining_Controllers"></a>Defining Controllers</h3><div class=CBody><p class=CParagraph>Controller definitions can be stored in app/controllers/&lt;controller_name&gt;_controller.sjs or in a module:app/modules/module_name/controllers/&lt;controller_name&gt;_controller.sjs.&nbsp; The primary source of configuration is the <a href="#Controller.init" class=LFunction id=link30 onMouseOver="ShowTip(event, 'tt9', 'link30')" onMouseOut="HideTip('tt9')">init</a> function.&nbsp; This is executed after the init() function in app/controllers/global.sjs.&nbsp; Any functions or properties defined in this file will be added to final Controller instance.</p><h4 class=CHeading>Functions called from init</h4><ul class=CBulletList><li><a href="#Controller.applyBehavior" class=LFunction id=link31 onMouseOver="ShowTip(event, 'tt4', 'link31')" onMouseOut="HideTip('tt4')">applyBehavior</a></li><li><a href="#Controller.addFilter" class=LFunction id=link32 onMouseOver="ShowTip(event, 'tt3', 'link32')" onMouseOut="HideTip('tt3')">addFilter</a></li><li><a href="#Controller.addLayout" class=LFunction id=link33 onMouseOver="ShowTip(event, 'tt1', 'link33')" onMouseOut="HideTip('tt1')">addLayout</a></li></ul><h4 class=CHeading>Examples</h4><blockquote><pre class="CCode sh_myna">// app/controllers/employee_action.sjs<br><br>function init(){<br>    // See: Behavior: MynaAuth in the docs<br>    // If this was in app/controlelr.global.sjs, it would aplpy to all<br>    // controllers, not just EmployeeActino<br>    this.applyBehavior(&quot;MynaAuth&quot;,{<br>        whitelist:[],<br>        providers:Myna.Permissions.getAuthTypes(),<br>        redirectParams:{}<br>    })<br>}<br><br>function edit(params){<br>    // Generate ID for new record if none-supplied. That way ID will be in<br>    // the URL and refreshing the page won't create a new record<br>    if (!params.id){<br>        $FP.redirectTo({<br>            id:this.model.genKey()<br>        })<br>    }<br><br>    // only get here if not re-directed<br>    this.set(&quot;bean&quot;,this.model.get(params);<br>    // this controller will automatically render<br>    // app/views/employee_action/edit.ejs<br>}</pre></blockquote><h4 class=CHeading>See</h4><ul class=CBulletList><li><a href="#Controller.init" class=LFunction id=link34 onMouseOver="ShowTip(event, 'tt9', 'link34')" onMouseOut="HideTip('tt9')">init</a></li><li><a href="#Controller.set" class=LFunction id=link35 onMouseOver="ShowTip(event, 'tt13', 'link35')" onMouseOut="HideTip('tt13')">set</a></li><li><a href="#Controller.render" class=LFunction id=link36 onMouseOver="ShowTip(event, 'tt10', 'link36')" onMouseOut="HideTip('tt10')">render</a></li><li><a href="#Controller.renderContent" class=LFunction id=link37 onMouseOver="ShowTip(event, 'tt11', 'link37')" onMouseOut="HideTip('tt11')">renderContent</a></li></ul></div></div>

<div class="CGroup CTopic"><h3 class=CTitle><a name="Controller.Properties"></a>Properties</h3></div>

<div class="CProperty CTopic"><h3 class=CTitle><a name="Controller.$page"></a>$page</h3><div class=CBody><p class=CParagraph>$page metadata object</p><p class=CParagraph>This can contain arbitrary metadata about the current page, but the following properties are used by the default layout file in app/views/layouts/default.ejs</p><h4 class=CHeading>Default Properties</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>css</td><td class=CDLDescription><b>String Array.</b> each entry should be either a complete &lt;link&gt; tag or a URL to a css file, e.g $FP.url +&rdquo;static/css/global.css&rdquo;.&nbsp; If a URL does NOT start with &ldquo;/&rdquo; or &ldquo;http&rdquo; it is assumed to be relative to app/static/</td></tr><tr><td class=CDLEntry>icon</td><td class=CDLDescription><b>String.</b> favicon url.&nbsp; Defaults to $server.rootUrl +&rdquo;favicon.ico&rdquo;</td></tr><tr><td class=CDLEntry>scripts</td><td class=CDLDescription><b>String/Object Array.</b>&nbsp; String entries should be URLs to JavaScript source files.&nbsp; Object entries should be in the form of {type:&rdquo;mime/type&rdquo;,src:&rdquo;url&rdquo;}.&nbsp; If a URL does NOT start with &ldquo;/&rdquo; or &ldquo;http&rdquo; it is assumed to be relative to app/static/</td></tr><tr><td class=CDLEntry>title</td><td class=CDLDescription><b>String.</b>&nbsp; Page Title.&nbsp; Defaults to $controller.name + &ldquo;.&rdquo;+$params.action</td></tr><tr><td class=CDLEntry>tags</td><td class=CDLDescription><b>Object Array.</b>&nbsp; Meta tags to add to header.&nbsp; Entries in the form of {name:&rdquo;meta tag name&rdquo;,content:&rdquo;tag content&rdquo;}</td></tr><tr><td class=CDLEntry>keywords</td><td class=CDLDescription><b>String Array.</b>&nbsp; &ldquo;keywords&rdquo; meta tag.&nbsp; Each entry will be joined into a comma-separated list</td></tr><tr><td class=CDLEntry>description</td><td class=CDLDescription><b>String.</b>&nbsp; Description meta tag</td></tr><tr><td class=CDLEntry>content</td><td class=CDLDescription>Set by <a href="#Controller.render" class=LFunction id=link38 onMouseOver="ShowTip(event, 'tt10', 'link38')" onMouseOut="HideTip('tt10')">render</a> when including layout files.&nbsp; This represents the current content that needs to be included in the layout</td></tr></table><h4 class=CHeading>Example</h4><blockquote><pre class="CCode sh_myna">//in test_controller.sjs<br>function init(){<br>    This.$page.title =&quot;Test&quot;<br>}<br><br>function index(params){<br>    this.$page.css.push(&quot;css/default.css&quot;)<br>    this.$page.scripts.push(&quot;/app/admin.js&quot;)<br>}<br><br>//loads js and CSS to support a ExtJs application with Ext.Direct support<br>function extIndex(params){<br>    // using concat instead of directly assigning values preserves any<br>    // existing values set in init()<br><br>    this.$page.css =this.$page.css.concat([<br>        &quot;extjs/resources/css/ext-all.css&quot;,<br>        &quot;css/default.css&quot;<br>    ])<br>    this.$page.scripts =this.$page.scripts.concat([<br>        &quot;extjs/ext-all-debug.js&quot;,<br>        // this is a JSONP callback to load the API from Controller: Direct<br>        $FP.helpers.Html.url({<br>            controller:&quot;Direct&quot;,<br>            action:&quot;api&quot;,<br>            params:{<br>                callback:&quot;Ext.Direct.addProvider&quot;,<br>                namespace:&quot;$FP&quot;<br>            }<br>        })<br>    ])<br>}</pre></blockquote></div></div>

<div class="CProperty CTopic"><h3 class=CTitle><a name="Controller.data"></a>data</h3><div class=CBody><p class=CParagraph>local request-specific data to be passed to views</p><h4 class=CHeading>See</h4><ul class=CBulletList><li><a href="#Controller.set" class=LFunction id=link39 onMouseOver="ShowTip(event, 'tt13', 'link39')" onMouseOut="HideTip('tt13')">set</a></li></ul></div></div>

<div class="CProperty CTopic"><h3 class=CTitle><a name="Controller.name"></a>name</h3><div class=CBody><p class=CParagraph>The name of this controller</p></div></div>

<div class="CGroup CTopic"><h3 class=CTitle><a name="Controller.Functions"></a>Functions</h3></div>

<div class="CFunction CTopic"><h3 class=CTitle><a name="Controller.addLayout"></a>addLayout</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.addLayout = function addLayout(</td><td class=PParameter nowrap>layout</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote><p class=CParagraph>adds a layout layer to this this request</p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>layout</td><td class=CDLDescription>String.&nbsp; Layout name, or path relative to app/layouts</td></tr></table><p class=CParagraph>This layout will in included after the global default layout, the controller default layout, and any previously defined layouts for this controller</p><h4 class=CHeading>See</h4><ul class=CBulletList><li><a href="FlightPath-txt.html#Layouts" class=LGeneric id=link40 onMouseOver="ShowTip(event, 'tt22', 'link40')" onMouseOut="HideTip('tt22')">Layouts</a></li></ul></div></div>

<div class="CFunction CTopic"><h3 class=CTitle><a name="Controller.setLayout"></a>setLayout</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.setLayout = function setLayout(</td><td class=PParameter nowrap>layout</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote><p class=CParagraph>Sets a single layout layer to this this request, clearing any existing layouts</p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>layout</td><td class=CDLDescription>String or Boolean.&nbsp; Layout name, or path relative to app/layouts, or false to disable all layouts</td></tr></table><h4 class=CHeading>Detail</h4><p class=CParagraph>disables global and controller default layouts.&nbsp; If <u>layout</u> is a layout name or path, then that will be the only layout applied</p><h4 class=CHeading>See</h4><ul class=CBulletList><li><a href="FlightPath-txt.html#Layouts" class=LGeneric id=link41 onMouseOver="ShowTip(event, 'tt22', 'link41')" onMouseOut="HideTip('tt22')">Layouts</a></li></ul></div></div>

<div class="CFunction CTopic"><h3 class=CTitle><a name="Controller.addFilter"></a>addFilter</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.addFilter = function addFilter(</td><td class=PParameter nowrap>filter,</td></tr><tr><td></td><td class=PParameter nowrap>options</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote><p class=CParagraph>Adds an action filter</p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>filter</td><td class=CDLDescription>Function or Array.&nbsp; Filter function to execute, or Array of filter functions to execute.&nbsp; See <b>Filter Function Parameters</b> below</td></tr><tr><td class=CDLEntry>options</td><td class=CDLDescription><b>Optional, default see below</b> JS struct, see <b>Options</b> below</td></tr></table><h4 class=CHeading>Options</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>when</td><td class=CDLDescription><b>Optional, default &ldquo;beforeAction&rdquo;</b> When the filter should be run. see <b>Events</b> below</td></tr><tr><td class=CDLEntry>only</td><td class=CDLDescription><b>Optional, default null</b> Array of String/RegExp.&nbsp; If defined, limit this filter to these action names.&nbsp; Mutually exclusive with <u>except</u></td></tr><tr><td class=CDLEntry>except</td><td class=CDLDescription><b>Optional, default null</b> Array String/RegExp.&nbsp; If defined, exclude this filter from these action names.&nbsp; Mutually exclusive with <u>only</u></td></tr></table><h4 class=CHeading>Filter Function Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>controller</td><td class=CDLDescription>Object reference to the controller to which this filter is applied</td></tr><tr><td class=CDLEntry>action</td><td class=CDLDescription>String name of action requested</td></tr><tr><td class=CDLEntry>params</td><td class=CDLDescription>the &ldquo;params&rdquo; argument passed to the action</td></tr><tr><td class=CDLEntry>response</td><td class=CDLDescription>The return from the action.&nbsp; This is always null for &ldquo;beforeAction&rdquo; filters</td></tr></table><h4 class=CHeading>Events</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>beforeAction</td><td class=CDLDescription>fired before executing an action function.&nbsp; Return false to cancel execution, return a JS object to supply new &ldquo;params&rdquo; to the action.&nbsp; Normally used to alter params or cancel routing, such as for authentication</td></tr><tr><td class=CDLEntry>afterAction</td><td class=CDLDescription>Fired after the action is complete but before default rendering.&nbsp; If the action contains an explicit <a href="#Controller.render" class=LFunction id=link42 onMouseOver="ShowTip(event, 'tt10', 'link42')" onMouseOut="HideTip('tt10')">render</a> or <a href="#Controller.renderContent" class=LFunction id=link43 onMouseOver="ShowTip(event, 'tt11', 'link43')" onMouseOut="HideTip('tt11')">renderContent</a> call then that will be executed first, without triggering &ldquo;beforeRender&rdquo; or &ldquo;afterRender&rdquo;.&nbsp; Return false or make a call to <a href="#Controller.render" class=LFunction id=link44 onMouseOver="ShowTip(event, 'tt10', 'link44')" onMouseOut="HideTip('tt10')">render</a> or <a href="#Controller.renderContent" class=LFunction id=link45 onMouseOver="ShowTip(event, 'tt11', 'link45')" onMouseOut="HideTip('tt11')">renderContent</a> to cancel the default render.&nbsp; Normally used for altering/adding properties to controller.data prior to rendering.&nbsp; Might also be used for custom rendering, but &ldquo;beforeRender&rdquo; is generally a better choice for that.</td></tr><tr><td class=CDLEntry>beforeRender</td><td class=CDLDescription>Fired before rendering the default view.&nbsp; Return false or make a call to <a href="#Controller.render" class=LFunction id=link46 onMouseOver="ShowTip(event, 'tt10', 'link46')" onMouseOut="HideTip('tt10')">render</a> or <a href="#Controller.renderContent" class=LFunction id=link47 onMouseOver="ShowTip(event, 'tt11', 'link47')" onMouseOut="HideTip('tt11')">renderContent</a> to cancel the default render.&nbsp; Normally used for custom renders that replace the default, such as rendering as RSS, or returning JSON</td></tr><tr><td class=CDLEntry>afterRender</td><td class=CDLDescription>Fired after the default render.&nbsp; Any changes to output should be made through <a href="../files/standard_objects/res-sjs.html#$res.clear" class=LFunction id=link48 onMouseOver="ShowTip(event, 'tt23', 'link48')" onMouseOut="HideTip('tt23')">$res.clear</a>, <a href="../files/standard_objects/res-sjs.html#$res.getContent" class=LFunction id=link49 onMouseOver="ShowTip(event, 'tt24', 'link49')" onMouseOut="HideTip('tt24')">$res.getContent</a>, <a href="../files/standard_objects/res-sjs.html#$res.print" class=LFunction id=link50 onMouseOver="ShowTip(event, 'tt25', 'link50')" onMouseOut="HideTip('tt25')">$res.print</a>, etc.&nbsp; Normally used to convert generated output such as converting to PDF or XHTML</td></tr></table><h4 class=CHeading>Detail</h4><p class=CParagraph>Filters are functions run before or after actions and/or before and after rendering the view for an action.&nbsp; Filters, by default, are run before every action, but can be applied to only specific actions.&nbsp; Great uses of filters are authentication and logging.&nbsp; Filters are only executed in standard request handling, <a href="#Controller.callAction" class=LFunction id=link51 onMouseOver="ShowTip(event, 'tt7', 'link51')" onMouseOut="HideTip('tt7')">callAction</a>, and <a href="#Controller.include" class=LFunction id=link52 onMouseOver="ShowTip(event, 'tt8', 'link52')" onMouseOut="HideTip('tt8')">include</a>.&nbsp; Direct execution of an action will not trigger filters.</p><h4 class=CHeading>Examples</h4><blockquote><pre class="CCode sh_myna">function init(){<br>    // exec an auth function before every action except<br>    // &quot;home&quot; and &quot;status&quot;<br>    this.addFilter(<br>        this._auth,<br>        {<br>            except:[&quot;home&quot;,&quot;status&quot;]<br>        }<br>    )<br><br>    //log only actions whose name starts with &quot;save&quot;<br>    this.addFilter(<br>        this._audit,<br>        {<br>            only:[/^save/i]<br>        }<br>    )<br><br>    this.addFilter(<br>        this._pdfView,<br>        {<br>            when:&quot;afterRender&quot;<br>        }<br>    )<br><br>}<br><br><br>// Functions that begin with &quot;_&quot; are not considered actions and<br>// are excluded from browser requests<br>function _auth(controller,action,params){<br>    if (!$cookie.getAuthUser()){<br>        $FP.redirectTo({<br>            controller:&quot;Auth&quot;,<br>            action:&quot;login&quot;<br>        })<br>        //unnecessary, becasue redirecTo halts processing, but good practice<br>        return false; //cancels action<br>    }<br>}<br><br>function _audit(controller,action,params){<br>    Myna.log(<br>        &quot;audit&quot;,<br>        controller.name + &quot;.&quot; + action,<br>        Myna.dump({<br>            params:params,<br>            user:$cookie.getAuthUser()<br>        })<br>    );<br>}<br><br>function _pdfView(controller, action, params){<br>    if (params.format ==&quot;pdf&quot;){<br>        // calling render or renderContent prevents default view from rendering<br>        this.renderContent(<br>            Myna.xmlToPdf(<br>                Myna.htmlToXhtml(<br>                    $res.clear()<br>                )<br>            ),<br>            &quot;application/pdf&quot;,<br>            params.controller + &quot;.&quot; + params.action + &quot;.pdf&quot;<br>        );<br>    }<br>}</pre></blockquote></div></div>

<div class="CFunction CTopic"><h3 class=CTitle><a name="Controller.applyBehavior"></a>applyBehavior</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.applyBehavior = function applyBehavior(</td><td class=PParameter nowrap>name,</td></tr><tr><td></td><td class=PParameter nowrap>options</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote><p class=CParagraph>loads a behavior and applies it to this object</p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>name</td><td class=CDLDescription>The ProperCased name of the behavior to load, or an array of these names,</td></tr><tr><td class=CDLEntry>options</td><td class=CDLDescription><b>Optional, defaul null</b> JS Object containing options to pass to the behavior&rsquo;s init function</td></tr></table><h4 class=CHeading>Detail</h4><p class=CParagraph>Loads a behavior by name from app/behaviors/controllers/ or framework/behaviors/controllers/, whichever is found first.&nbsp; Behaviors are functions that are applied to the current object.&nbsp; <a href="#Controller.applyBehavior" class=LFunction id=link53 onMouseOver="ShowTip(event, 'tt4', 'link53')" onMouseOut="HideTip('tt4')">applyBehavior</a> should be called from <a href="#Controller.init" class=LFunction id=link54 onMouseOver="ShowTip(event, 'tt9', 'link54')" onMouseOut="HideTip('tt9')">init</a></p><h4 class=CHeading>Example</h4><blockquote><pre class="CCode sh_myna">//in some_controller.sjs<br>function init(){<br>    // loads the built-in PDF andJSON filters<br>    // Each of these has an &quot;init&quot; function that adds the appropriate<br>    // before and after filters<br>    this.applyBehavior([<br>        &quot;FormatPdf&quot;,<br>        &quot;FormatJson&quot;<br>    ]);<br><br>    //loads a single behavior with options<br>    this.applyBehavior(&quot;MynaAuth&quot;,{<br>        whitelist:[<br>            &quot;Main.index&quot;,<br>            &quot;Main.logout&quot;<br>        ],<br>        redirectParams:{<br>            message: &quot;Enter your AD domain credentials&quot;,<br>            providers:[&quot;ldap_ad&quot;]<br>        }<br>    });<br>}</pre></blockquote><h4 class=CHeading>See</h4><ul class=CBulletList><li><a href="FlightPath-txt.html#Behaviors" class=LGeneric id=link55 onMouseOver="ShowTip(event, 'tt26', 'link55')" onMouseOut="HideTip('tt26')">Behaviors</a></li></ul></div></div>

<div class="CFunction CTopic"><h3 class=CTitle><a name="Controller.getFilters"></a>getFilters</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.getFilters = function addFilter(</td><td class=PParameter nowrap>event,</td></tr><tr><td></td><td class=PParameter nowrap>action</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote><p class=CParagraph>returns the filter array for the requested event and action.</p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>event</td><td class=CDLDescription>event name</td></tr><tr><td class=CDLEntry>action</td><td class=CDLDescription>action name</td></tr></table><h4 class=CHeading>See</h4><ul class=CBulletList><li><a href="#Controller.addFilter" class=LFunction id=link56 onMouseOver="ShowTip(event, 'tt3', 'link56')" onMouseOut="HideTip('tt3')">addFilter</a></li></ul></div></div>

<div class="CFunction CTopic"><h3 class=CTitle><a name="Controller.getActions"></a>getActions</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>Controller.prototype.getActions = function getActions()</td></tr></table></blockquote><p class=CParagraph>returns an array of objects for each action that contain the action name and action function.</p><h4 class=CHeading>Object Properties</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>action</td><td class=CDLDescription>String action name</td></tr><tr><td class=CDLEntry>handler</td><td class=CDLDescription>Function reference to action function</td></tr></table></div></div>

<div class="CFunction CTopic"><h3 class=CTitle><a name="Controller.callAction"></a>callAction</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.callAction = function callAction(</td><td class=PParameter nowrap>action,</td></tr><tr><td></td><td class=PParameter nowrap>params</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote><p class=CParagraph>Call an action as an inline function.</p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>action</td><td class=CDLDescription>action name to execute</td></tr><tr><td class=CDLEntry>params</td><td class=CDLDescription><b>Optional, default {}</b> params to pass to the action</td></tr></table><h4 class=CHeading>Detail</h4><p class=CParagraph>Calling this function on a controller will execute the specified action &ldquo;inline&rdquo;, meaning without generating output, and will return whatever the action returns.&nbsp; Before and after action filters are also triggered.&nbsp; This can be useful for marshaling several actions in one request, or for providing alternate ways of calling actions (see &lt;framework.controllers.DirectController&gt;)</p><h4 class=CHeading>Example</h4><blockquote><pre class="CCode sh_myna">//triggers filters, so will fail if cur user is not authorized<br>var empList = $FP.getController(&quot;employee&quot;).callAction(&quot;list&quot;,params);</pre></blockquote><h4 class=CHeading>Note</h4><p class=CParagraph>You can also call actions directly from a controller, but filters won&rsquo;t be triggered.</p><blockquote><pre class="CCode sh_myna">// does not run filters, but might render output if render() or<br>// renderContent() is called inside this action<br>var empList = $FP.getController(&quot;employee&quot;).list(params);</pre></blockquote></div></div>

<div class="CFunction CTopic"><h3 class=CTitle><a name="Controller.include"></a>include</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.include = function include(</td><td class=PParameter nowrap>action,</td></tr><tr><td></td><td class=PParameter nowrap>params</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote><p class=CParagraph>Call an action and includes its output in the current request</p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>action</td><td class=CDLDescription>action name to execute</td></tr><tr><td class=CDLEntry>params</td><td class=CDLDescription><b>Optional, default {}</b> params to pass to the action</td></tr></table><h4 class=CHeading>Detail</h4><p class=CParagraph>Calling this function on a controller will execute the specified action, appending any output generated to the current request.&nbsp; This will also return any response from the action.&nbsp; Before and after action filters are also triggered.&nbsp; This can be useful for including several actions in one request.</p><h4 class=CHeading>Example</h4><blockquote><pre class="CCode sh_myna">// triggers filters, so will fail if cur user is not authorized<br>// includes employee listing table in the current view<br>$FP.getController(&quot;employee&quot;).callAction(&quot;list&quot;,params);</pre></blockquote></div></div>

<div class="CFunction CTopic"><h3 class=CTitle><a name="Controller.init"></a>init</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.init = function init(</td><td class=PParameter nowrap>controllerName</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote><p class=CParagraph>Initializes a controller instance</p><p class=CParagraph>Whenever a controller is instantiated, init() is run to configure the instance.&nbsp; First the init() in the controller base class is run, then the init() in app/controllers/global.sjs, and finally the init() in app/controllers/&lt;name&gt;_controller.sjs</p><p class=CParagraph>This is a good place to call this.applyBehavior, this.addFilter and this.add/setLayout</p><h4 class=CHeading>See Also</h4><ul class=CBulletList><li><a href="#Controller.applyBehavior" class=LFunction id=link57 onMouseOver="ShowTip(event, 'tt4', 'link57')" onMouseOut="HideTip('tt4')">applyBehavior</a></li><li><a href="#Controller.addFilter" class=LFunction id=link58 onMouseOver="ShowTip(event, 'tt3', 'link58')" onMouseOut="HideTip('tt3')">addFilter</a></li><li><a href="#Controller.addLayout" class=LFunction id=link59 onMouseOver="ShowTip(event, 'tt1', 'link59')" onMouseOut="HideTip('tt1')">addLayout</a></li></ul></div></div>

<div class="CFunction CTopic"><h3 class=CTitle><a name="Controller.render"></a>render</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.render = function render(</td><td class=PParameter nowrap>options</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote><p class=CParagraph>renders a view</p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>options</td><td class=CDLDescription><b>Optional</b> String or Object or null.&nbsp; If a string, the filename of the view in app/views to load, minus the extension.&nbsp; If this is null, then rendering is canceled.&nbsp; If this is an object or undefined, see <b>Options</b> below:</td></tr></table><h4 class=CHeading>Options</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>controller</td><td class=CDLDescription><b>Optional, default current controller</b> ProperCased controller folder within app/views to reference.&nbsp; This will be converted to file format automatically</td></tr><tr><td class=CDLEntry>action</td><td class=CDLDescription><b>Optional, default current action</b> camelCased action name.&nbsp; This will be converted to file format automatically</td></tr></table><h4 class=CHeading>Detail</h4><p class=CParagraph>This function is called automatically with default <u>options</u> whenever an action function returns.&nbsp; This function can be called explicitly from inside an action function to override this default behavior</p><p class=CParagraph>When rendering a view, all previously generated content is cleared, and the view is included.&nbsp; Once the view is rendered, it is wrapped in any defined layouts (see &lt;addLayout&gt;)  The following variables are available in view scope, and can be directly referenced:</p><h4 class=CHeading>View Scope properties</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>$controller</td><td class=CDLDescription>A reference to the controller that called this view</td></tr><tr><td class=CDLEntry>$model</td><td class=CDLDescription>A reference to this controllers default model, may be null</td></tr><tr><td class=CDLEntry>$params</td><td class=CDLDescription>A reference to the params of the most recent action</td></tr><tr><td class=CDLEntry>$page</td><td class=CDLDescription>a reference to this controller&rsquo;s <a href="#Controller.$page" class=LProperty id=link60 onMouseOver="ShowTip(event, 'tt27', 'link60')" onMouseOut="HideTip('tt27')">$page</a> property</td></tr><tr><td class=CDLEntry>getElement</td><td class=CDLDescription>a reference to <a href="#Controller.getElement" class=LFunction id=link61 onMouseOver="ShowTip(event, 'tt12', 'link61')" onMouseOut="HideTip('tt12')">getElement</a></td></tr><tr><td class=CDLEntry>[data properties]</td><td class=CDLDescription>all of this controller&rsquo;s <a href="#Controller.data" class=LProperty id=link62 onMouseOver="ShowTip(event, 'tt14', 'link62')" onMouseOut="HideTip('tt14')">data</a> properties are available as global variables</td></tr><tr><td class=CDLEntry>[$FP.helpers classes]</td><td class=CDLDescription>&rdquo;Html&rdquo; refers to $FP.helpers.Html, etc</td></tr></table><h4 class=CHeading>Examples</h4><blockquote><pre class="CCode sh_myna">//in app/controllers/person_controller.sjs<br>function doStuff(params){<br>    //bulk sets/replaces this.data<br>    this.set({<br>        firstName:&quot;Bob&quot;,<br>        lastName:&quot;Dobb&quot;<br>    })<br><br>    //sets an individual property<br>    this.set(&quot;bean&quot;,this.Person.get({id:params.id}))<br><br>    // implied render, same as<br>    // this.render({controller:this.name,action:&quot;doStuff&quot;})<br>}<br><br>//in app/views/person/person_do_stuff.ejs<br>&lt;%=getElement(&quot;form_wrap&quot;,{title:&quot;Edit Employee&quot;})%&gt;<br>&lt;form action=&quot;&lt;%=Html.url({action:&quot;save&quot;,id:bean.id})%&gt;&quot; method=&quot;post&quot;&gt;<br>&lt;table width=&quot;100%&quot; height=&quot;1&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; border=&quot;0&quot; &gt;<br>    &lt;tr&gt;<br>        &lt;th class=&quot;&quot;&gt;ID:&lt;/th&gt;&lt;td&gt;&lt;%=bean.id%&gt;&lt;td&gt;<br>    &lt;/tr&gt;<br><br>    &lt;tr&gt;<br>        &lt;th&gt;&lt;%=bean.getLabel(&quot;first_name&quot;)%&gt;:&lt;/th&gt;<br>        &lt;td&gt;&lt;input name=&quot;first_name&quot; value=&quot;&lt;%=String(bean.data.first_name||&quot;&quot;).escapeHtml()%&gt;&quot;&gt;&lt;td&gt;<br>    &lt;/tr&gt;<br>    &lt;tr&gt;<br>        &lt;th&gt;&lt;%=bean.getLabel(&quot;last_name&quot;)%&gt;:&lt;/th&gt;<br>        &lt;td&gt;&lt;input name=&quot;last_name&quot; value=&quot;&lt;%=String(bean.data.last_name||&quot;&quot;).escapeHtml()%&gt;&quot;&gt;&lt;td&gt;<br>    &lt;/tr&gt;<br><br>    &lt;tr&gt;<br>        &lt;td colspan=&quot;2&quot; align=&quot;right&quot;&gt;<br>            &lt;button type=&quot;submit&quot;&gt;Save&lt;/button&gt;<br>        &lt;/td&gt;<br>    &lt;/tr&gt;<br>&lt;/table&gt;<br>&lt;/form&gt;<br>&lt;%=getElement(&quot;form_wrap&quot;,{type:&quot;end&quot;})%&gt;<br><br><br>//in app/elements/form_wrap.ejs<br>&lt;@if type == &quot;end&quot;&gt;<br>    &lt;/div&gt;<br>&lt;@else&gt;<br>    &lt;div class=&quot;form_wrap&quot;&gt;<br>    &lt;div class=&quot;caption&quot;&gt;&lt;%=title||&quot;&quot;%&gt;&lt;/div&gt;<br>&lt;/@if&gt;<br><br>//in app/elements/form_footer.ejs<br>&lt;/div&gt;</pre></blockquote><h4 class=CHeading>See</h4><ul class=CBulletList><li><a href="FlightPath-txt.html#Views" class=LGeneric id=link63 onMouseOver="ShowTip(event, 'tt17', 'link63')" onMouseOut="HideTip('tt17')">Views</a></li></ul></div></div>

<div class="CFunction CTopic"><h3 class=CTitle><a name="Controller.renderContent"></a>renderContent</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.renderContent = function renderBinary(</td><td class=PParameter nowrap>data,</td></tr><tr><td></td><td class=PParameter nowrap>contentType,</td></tr><tr><td></td><td class=PParameter nowrap>filename</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote><p class=CParagraph>Directly render content, bypassing default render</p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>data</td><td class=CDLDescription>String content, or binary data from <a href="../files/File-sjs.html#Myna.File.readBinary" class=LFunction id=link64 onMouseOver="ShowTip(event, 'tt28', 'link64')" onMouseOut="HideTip('tt28')">Myna.File.readBinary</a> or from binary database query (byte [])</td></tr><tr><td class=CDLEntry>contentType</td><td class=CDLDescription><b>Optional, default text/html for strings, application/octet-stream for binary</b> MIME type of <u>data</u>.&nbsp; If &ldquo;&rdquo; or null, the default will be used</td></tr><tr><td class=CDLEntry>filename</td><td class=CDLDescription><b>Optional, default null</b> if defined, a &ldquo;Content-disposition&rdquo; response header is set to present the standard &ldquo;Save or Open?&rdquo; dialog to the client.&nbsp; Use this if offering a file for download, but not if you expect the content to be rendered inline</td></tr></table><h4 class=CHeading>See</h4><p class=CParagraph><a href="../files/standard_objects/res-sjs.html#$res.printBinary" class=LFunction id=link65 onMouseOver="ShowTip(event, 'tt29', 'link65')" onMouseOut="HideTip('tt29')">$res.printBinary</a></p></div></div>

<div class="CFunction CTopic"><h3 class=CTitle><a name="Controller.getElement"></a>getElement</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.getElement = function renderElement(</td><td class=PParameter nowrap>element,</td></tr><tr><td></td><td class=PParameter nowrap>options</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote><p class=CParagraph>renders an HTML template returns the content as a string</p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>element</td><td class=CDLDescription>name of an element template, should map to app/views/elements/<u>element</u> (can be a path like &ldquo;common/header.ejs&rdquo;) app/views/elements/&lt;current controller name&gt;/<u>element</u>.ejs, or app/views/elements/<u>element</u>.ejs,</td></tr><tr><td class=CDLEntry>options</td><td class=CDLDescription>any extra global properties to pass to the template</td></tr></table><h4 class=CHeading>Element Scope properties</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>$controller</td><td class=CDLDescription>A reference to the controller that called this element</td></tr><tr><td class=CDLEntry>$model</td><td class=CDLDescription>A reference to this controllers default model, may be null</td></tr><tr><td class=CDLEntry>$params</td><td class=CDLDescription>A reference to the params of the most recent action</td></tr><tr><td class=CDLEntry>$page</td><td class=CDLDescription>a reference to this controller&rsquo;s <a href="#Controller.$page" class=LProperty id=link66 onMouseOver="ShowTip(event, 'tt27', 'link66')" onMouseOut="HideTip('tt27')">$page</a> property</td></tr><tr><td class=CDLEntry>[data properties]</td><td class=CDLDescription>all of this controller&rsquo;s <a href="#Controller.data" class=LProperty id=link67 onMouseOver="ShowTip(event, 'tt14', 'link67')" onMouseOut="HideTip('tt14')">data</a> properties are available as global variables</td></tr><tr><td class=CDLEntry>[options properties]</td><td class=CDLDescription>all <u>options</u> properties are available as global variables</td></tr><tr><td class=CDLEntry>[$FP.helpers classes]</td><td class=CDLDescription>&rdquo;Html&rdquo; refers to $FP.helpers.Html, etc</td></tr></table><p class=CParagraph>This function is normally used inside view templates.&nbsp; See <a href="#Controller.render" class=LFunction id=link68 onMouseOver="ShowTip(event, 'tt10', 'link68')" onMouseOut="HideTip('tt10')">render</a> for example usage</p><h4 class=CHeading>Examples</h4><blockquote><pre class="CCode sh_myna">//in app/views/test/index.ejs<br><br>&lt;%=getElement(&quot;shared/common_commonlinks.ejs&quot;)%&gt;<br>&lt;%=getElement()%&gt;</pre></blockquote><h4 class=CHeading>See</h4><ul class=CBulletList><li><a href="FlightPath-txt.html#Elements" class=LGeneric id=link69 onMouseOver="ShowTip(event, 'tt30', 'link69')" onMouseOut="HideTip('tt30')">Elements</a></li></ul></div></div>

<div class="CFunction CTopic"><h3 class=CTitle><a name="Controller.set"></a>set</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.set = function set(</td><td class=PParameter nowrap>prop,</td></tr><tr><td></td><td class=PParameter nowrap>val</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote><p class=CParagraph>Sets a property on <a href="#Controller.data" class=LProperty id=link70 onMouseOver="ShowTip(event, 'tt14', 'link70')" onMouseOut="HideTip('tt14')">data</a></p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>prop</td><td class=CDLDescription>Either String property name to set, or JS object containing key/value pairs.&nbsp; This will overwrite same-named properties but will preserver any other existing properties</td></tr><tr><td class=CDLEntry>val</td><td class=CDLDescription>value to set</td></tr></table><p class=CParagraph>All top level properties of <a href="#Controller.data" class=LProperty id=link71 onMouseOver="ShowTip(event, 'tt14', 'link71')" onMouseOut="HideTip('tt14')">data</a> become global variables in views and elements.</p><p class=CParagraph>Returns <u>val</u></p><h4 class=CHeading>Examples</h4><blockquote><pre class="CCode sh_myna">function myAction(params){<br>    //set single property<br>    this.set(&quot;firstName&quot;,&quot;Bob&quot;)<br><br>    //set multiple properties, preserves &quot;firstName&quot; set earlier<br>    this.set({<br>        lastName:&quot;Dobb&quot;,<br>        age:56<br>    })<br><br>    //you can also directly manipulate the data object<br>    this.data.position=&quot;Slackmaster&quot;<br>}</pre></blockquote></div></div>

</div><!--Content-->


<div id=Footer><a href="http://www.naturaldocs.org">Generated by Natural Docs</a></div><!--Footer-->






<!--START_ND_TOOLTIPS-->
<div class=CToolTip id="tt1"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.addLayout = function addLayout(</td><td class=PParameter nowrap>layout</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>adds a layout layer to this this request</div></div><div class=CToolTip id="tt2"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.setLayout = function setLayout(</td><td class=PParameter nowrap>layout</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>Sets a single layout layer to this this request, clearing any existing layouts</div></div><div class=CToolTip id="tt3"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.addFilter = function addFilter(</td><td class=PParameter nowrap>filter,</td></tr><tr><td></td><td class=PParameter nowrap>options</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>Adds an action filter</div></div><div class=CToolTip id="tt4"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.applyBehavior = function applyBehavior(</td><td class=PParameter nowrap>name,</td></tr><tr><td></td><td class=PParameter nowrap>options</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>loads a behavior and applies it to this object</div></div><div class=CToolTip id="tt5"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.getFilters = function addFilter(</td><td class=PParameter nowrap>event,</td></tr><tr><td></td><td class=PParameter nowrap>action</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>returns the filter array for the requested event and action.</div></div><div class=CToolTip id="tt6"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>Controller.prototype.getActions = function getActions()</td></tr></table></blockquote>returns an array of objects for each action that contain the action name and action function.</div></div><div class=CToolTip id="tt7"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.callAction = function callAction(</td><td class=PParameter nowrap>action,</td></tr><tr><td></td><td class=PParameter nowrap>params</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>Call an action as an inline function.</div></div><div class=CToolTip id="tt8"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.include = function include(</td><td class=PParameter nowrap>action,</td></tr><tr><td></td><td class=PParameter nowrap>params</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>Call an action and includes its output in the current request</div></div><div class=CToolTip id="tt9"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.init = function init(</td><td class=PParameter nowrap>controllerName</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>Initializes a controller instance</div></div><div class=CToolTip id="tt10"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.render = function render(</td><td class=PParameter nowrap>options</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>renders a view</div></div><div class=CToolTip id="tt11"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.renderContent = function renderBinary(</td><td class=PParameter nowrap>data,</td></tr><tr><td></td><td class=PParameter nowrap>contentType,</td></tr><tr><td></td><td class=PParameter nowrap>filename</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>Directly render content, bypassing default render</div></div><div class=CToolTip id="tt12"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.getElement = function renderElement(</td><td class=PParameter nowrap>element,</td></tr><tr><td></td><td class=PParameter nowrap>options</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>renders an HTML template returns the content as a string</div></div><div class=CToolTip id="tt13"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>Controller.prototype.set = function set(</td><td class=PParameter nowrap>prop,</td></tr><tr><td></td><td class=PParameter nowrap>val</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>Sets a property on data</div></div><div class=CToolTip id="tt14"><div class=CProperty>local request-specific data to be passed to views</div></div><div class=CToolTip id="tt15"><div class=CGeneric>In FlightPath, controllers (the C in MVC) are represented by the Controller class.</div></div><div class=CToolTip id="tt16"><div class=CClass>Data Modeling base class. </div></div><div class=CToolTip id="tt17"><div class=CGeneric>View Templates are .ejs templates used to render the result of an action. </div></div><div class=CToolTip id="tt18"><div class=CGeneric>Routes are URL patterns that can be mapped to controllers and actions. </div></div><div class=CToolTip id="tt19"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>function getController(</td><td class=PParameter nowrap>controllerName</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>factory function to find a a controller by name, instantiate it, initialize it, and return it.</div></div><div class=CToolTip id="tt20"><div class=CGeneric>Controller definitions can be stored in app/controllers/&lt;controller_name&gt;_controller.sjs or in a module:app/modules/module_name/controllers/&lt;controller_name&gt;_controller.sjs. </div></div><div class=CToolTip id="tt21"><div class=CGeneric>Myna FlightPath is a Model-View-Controller(MVC) web application framework inspired by CakePHP, CFWheels and Ruby On Rails.</div></div><div class=CToolTip id="tt22"><div class=CGeneric>A layout file is a specialized view (see: Views) that is intended to wrap content before sending it to the browser.</div></div><div class=CToolTip id="tt23"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>clear:function ()</td></tr></table></blockquote>Clears response buffer and returns the previous contents.</div></div><div class=CToolTip id="tt24"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>getContent:function ()</td></tr></table></blockquote>Returns current response buffer contents.</div></div><div class=CToolTip id="tt25"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>print:function (</td><td class=PParameter nowrap>text</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>Appends content to the response buffer.</div></div><div class=CToolTip id="tt26"><div class=CGeneric>Behaviors are functions that are applied to the current object.</div></div><div class=CToolTip id="tt27"><div class=CProperty>$page metadata object</div></div><div class=CToolTip id="tt28"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>Myna.File.prototype.readBinary = function()</td></tr></table></blockquote>returns the contents of this file as a java byte[] array</div></div><div class=CToolTip id="tt29"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>printBinary:function(</td><td class=PParameter nowrap>data,</td></tr><tr><td></td><td class=PParameter nowrap>contentType,</td></tr><tr><td></td><td class=PParameter nowrap>filename</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>sends binary data to the browser</div></div><div class=CToolTip id="tt30"><div class=CGeneric>An element file is a specialized view (see: Views) that is intended to contain a fragment of output (usually HTML) that can be used in a view</div></div><!--END_ND_TOOLTIPS-->




<script language=JavaScript><!--
if (browserType) {if (browserVer) {document.write("</div>"); }document.write("</div>");}// --></script></body></html>