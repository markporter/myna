<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!--
JsUnit - a JUnit port for JavaScript
Copyright (C) 1999,2000,2001,2002,2003,2006,2007 Joerg Schaible

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<html><head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>JsUnit: Usage</title>
<link href="JsUnit.css" rel="stylesheet" type="text/css">
</head><body>
<table width="100%" class="header"><tr>
<td width="100%"><div class="header"><span class="J">J</span><span class="s">s</span><span class="U">U</span>nit <small>1.3</small></div></td>
<td>
<form action="https://www.paypal.com/cgi-bin/webscr" method="post">
<input type="hidden" name="cmd" value="_xclick">
<input type="hidden" name="business" value="joehni@mail.berlios.de">
<input type="hidden" name="item_name" value="JsUnit">
<input type="image" src="PayPal.png" border="0" name="submit" alt="Make a donation using PayPal">
</form></td>
<td><a href="http://developer.berlios.de/projects/jsunit"><img name="HeadBerliOS" src="berlios.png" width="118" height="52" border="0" alt="Project Developer Home"></a></td>
<td><a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border=0 width=110 height=52></a></td>
</tr></table>
<script type="text/javascript" language="JavaScript">
<!--
// Reference BerliOS if viewed in the web.
if(   window.location.protocol.indexOf( "http", 0 ) == 0
   && window.location.host != "localhost" 
   && window.location.host != "127.0.0.1" )
{
    document.HeadBerliOS.src = "http://developer.berlios.de/sflogo.php?group_id=158&type=1";
}
//-->
</script>
<hr>

<!-- Generated by Doxygen 1.5.2 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="classes.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul>
</div>
<h1><a class="anchor" name="usage">Usage</a></h1> 

<div class="JsUnit">

<h2><a class="anchor" name="generalusage">
General Usage</a></h2>
<h3><a class="anchor" name="codeConv">
Coding Conventions</a></h3>
To create an object in JavaScript you have to use the new operator. Every time this operator will call a function that creates automatically the new object implicitly. The new object is of the type of the function. This means the function's code represents the class definition, the "constructor" is the function call itself. Since JsUnit 1.2 the standard inheritance mechanism described in the <a href="http://developer.netscape.com/docs/manuals/js/core/jsguide15/obj2.html">JavaScript guide 1.5 for the object model</a> is supported and preferred.<p>
JsUnit follows the scheme that all member variables are declared within this constructor. Afterwards all member functions are declared, using the name schema classname_memberfunctionname. All member functions are then added to the prototype of the class. This prevents naming conflicts in the global namespace. The first section within the constructor is used for the inheritance. Call a base class by using the call method of its constructor:<p>
<div class="fragment"><pre class="fragment">function ClassName( arg1, arg2 )
{
    BaseClass.call( <span class="keyword">this</span>, arg1, arg2 );
}
</pre></div><p>
After calling the constructor you should initialize the member variables by assigning them a value:<p>
<div class="fragment"><pre class="fragment"><span class="keyword">this</span>.mMember1 = 1;
<span class="keyword">this</span>.mMember2 = <span class="stringliteral">"yes"</span>;
</pre></div><p>
After writing the constructor it is the time to define all member functions. Declare the function using the class name as prefix. Assign all functions afterwards to the prototype:<p>
<div class="fragment"><pre class="fragment">function ClassName_f1() {}
function ClassName_f2() {}

ClassName.prototype = <span class="keyword">new</span> BaseClass();
ClassName.prototype.f1 = ClassName_f1;
ClassName.prototype.f2 = ClassName_f2;
</pre></div><p>
The assignment of the methods is quite cumbersome for a big number of member functions and it is easy to forget one. Therefore the <em><a class="el" href="classFunction.html" title="Standard ECMA class.">Function</a></em> object has been enhanced with a new method <em>glue</em> that automates this assignment as long as the naming convention is honored:<p>
<div class="fragment"><pre class="fragment">function ClassName_f1() {}
function ClassName_f2() {}

ClassName.prototype = <span class="keyword">new</span> BaseClass();
ClassName.glue();
</pre></div><p>
It is no problem to overload a function that was already assigned in a the base class. Call the overloaded function using its apply or call method in the prototype of the constructor:<p>
<div class="fragment"><pre class="fragment">function ClassName_f1() 
{
    BaseClass.prototype.f1.apply( <span class="keyword">this</span>, arguments );
}
<span class="comment">//...</span>
ClassName.prototype.f1 = ClassName_f1;
</pre></div><p>
You may also define static member variables using a prototype definition:<p>
<div class="fragment"><pre class="fragment">ClassName.prototype.v1 = 1;
</pre></div><h3><a class="anchor" name="altSyntax">
Alternative Syntax</a></h3>
The previous chapter followed the coding convention of the JavaScript Reference Guide. A convention always imply you may use an alternative coding style, the Perl script <a class="el" href="internal.html#docScript">js2doxy.pl</a> will understand even this:<p>
<div class="fragment"><pre class="fragment">function ClassName( arg1, arg2 )
{
    BaseClass.call( <span class="keyword">this</span>, arg1, arg2 );
}
ClassName.prototype = <span class="keyword">new</span> BaseClass();
ClassName.prototype.f1 = function ClassName_f1( arg1 ) 
{
    BaseClass.prototype.f1.call( <span class="keyword">this</span>, arg1 );
}
ClassName.prototype.f2 = function() 
{
    BaseClass.prototype.f2.apply( <span class="keyword">this</span>, arguments );
}
ClassName.prototype.v1 = 1;
</pre></div><p>
The advantage of method <code>f2</code> definition is, that the code is quite compact and keeps the global namespace clean. The disadvantage is that the function itself has no name and the call stack (if supported by the engine) will return an anonymous function call.<h3><a class="anchor" name="interface">
Interfaces</a></h3>
JavaScript does not support interfaces (although <em>implements</em> is a keyword). Since it is quite handy to be sure that a class supports a defined number of functions, the system implements a new member function <em>fulfills</em> of the class <a class="el" href="classFunction.html" title="Standard ECMA class.">Function</a> that performs this action. Since the functions of an interface are never called, they can be implemented quite minimalistic:<p>
<div class="fragment"><pre class="fragment">function InterfaceName() {}
InterfaceName.prototype.f1 = function() {}
InterfaceName.prototype.f2 = function( a, b ) {}
</pre></div><p>
An interface definition may only define member functions, but no member variables. To ensure that a class fulfills this interface you call its function <em>fulfills</em> <p>
<div class="fragment"><pre class="fragment">ClassName()
{
}
<span class="comment">//...</span>
ClassName.prototype.f1 = ClassName_f1;
ClassName.prototype.f2 = ClassName_f2;
ClassName.fulfills( InterfaceName );
</pre></div><h3><a class="anchor" name="writing">
Writing test cases and test suites</a></h3>
<p>
Writing unit tests you have to write at first test cases for your classes. The programming paradigm of eXtreme Programming demands writing your test cases first. Then you are able to program your class against the test case, so you know when you are ready. Anyway, writing a test case means deriving from class <a class="el" href="classTestCase.html" title="A test case defines the fixture to run multiple tests.">TestCase</a>:<p>
<div class="fragment"><pre class="fragment">function SimpleTest(name)
{
    <a class="code" href="classTestCase.html" title="A test case defines the fixture to run multiple tests.">TestCase</a>.call( <span class="keyword">this</span>, name );
}
</pre></div><p>
Overload the setUp function if necessary:<p>
<div class="fragment"><pre class="fragment">function SimpleTest_setUp()
{
    <span class="keyword">this</span>.fValue1= 2;
    <span class="keyword">this</span>.fValue2= 3;
}
</pre></div><p>
Add your test fixtures:<p>
<div class="fragment"><pre class="fragment">function SimpleTest_testDivideByZero()
{
    var zero = 0;
    <span class="keyword">this</span>.assertEquals( <span class="stringliteral">"Infinity"</span>, 8/zero );
}
</pre></div><p>
You may also overload the tearDown function. To complete the class you have to assign the methods<p>
<div class="fragment"><pre class="fragment"></pre></div><p>
In a final step you have to create a <a class="el" href="classTestSuite.html" title="A TestSuite is a composition of Tests.">TestSuite</a> out of all your test classes. Derive your own test suite from the <a class="el" href="classTestSuite.html" title="A TestSuite is a composition of Tests.">TestSuite</a>:<p>
<div class="fragment"><pre class="fragment"></pre></div><p>
You may add as many test classes as you want or even other test suites. The test methods will automatically found if they follow the naming conventions.<h3><a class="anchor" name="application">
Creating a test application</a></h3>
After writing the test cases we need an application to run the tests. The application has the responsibility to include all necessary sources. Create a <a class="el" href="classTestRunner.html" title="TestRunner of JsUnit 1.1.">TestRunner</a> for reporting the results, add all wanted test suites to the runner and perform the test. The <a class="el" href="classTestRunner.html" title="TestRunner of JsUnit 1.1.">TestRunner</a> itself is normally also a derived class, that has reporting functions that work perfectly in the system environment. See below a sample callable from the JavaScript shells:<p>
<div class="fragment"><pre class="fragment"><span class="comment">/*</span>
<span class="comment">JsUnit - a JUnit port for JavaScript</span>
<span class="comment">Copyright (C) 1999,2000,2001,2002,2003,2006 Joerg Schaible</span>
<span class="comment"></span>
<span class="comment">Licensed under the Apache License, Version 2.0 (the "License");</span>
<span class="comment">you may not use this file except in compliance with the License.</span>
<span class="comment">You may obtain a copy of the License at</span>
<span class="comment"></span>
<span class="comment">    http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="comment"></span>
<span class="comment">Unless required by applicable law or agreed to in writing, software</span>
<span class="comment">distributed under the License is distributed on an "AS IS" BASIS,</span>
<span class="comment">WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="comment">See the License for the specific language governing permissions and</span>
<span class="comment">limitations under the License.</span>
<span class="comment">*/</span>

<span class="keywordflow">if</span>( !<span class="keyword">this</span>.<a class="code" href="classJsUtil.html" title="Helper class with static flags.">JsUtil</a> )
{
    <span class="keywordflow">if</span>( <span class="keyword">this</span>.WScript )
    {
        var fso = <span class="keyword">new</span> ActiveXObject( <span class="stringliteral">"Scripting.FileSystemObject"</span> );
        var file = fso.OpenTextFile( <span class="stringliteral">"../lib/JsUtil.js"</span>, 1 );
        var all = file.ReadAll();
        file.Close();
        eval( all );
    }
    <span class="keywordflow">else</span>
        load( <span class="stringliteral">"../lib/JsUtil.js"</span> );
    
    eval( JsUtil.prototype.include( <span class="stringliteral">"../lib/JsUnit.js"</span> ));
    eval( JsUtil.prototype.include( <span class="stringliteral">"ArrayTest.js"</span> ));
    eval( JsUtil.prototype.include( <span class="stringliteral">"demo/Demo.js"</span> ));
    eval( JsUtil.prototype.include( <span class="stringliteral">"demo/DemoTest.js"</span> ));
    eval( JsUtil.prototype.include( <span class="stringliteral">"money/IMoney.js"</span> ));
    eval( JsUtil.prototype.include( <span class="stringliteral">"money/Money.js"</span> ));
    eval( JsUtil.prototype.include( <span class="stringliteral">"money/MoneyBag.js"</span> ));
    eval( JsUtil.prototype.include( <span class="stringliteral">"money/MoneyTest.js"</span> ));
    eval( JsUtil.prototype.include( <span class="stringliteral">"SimpleTest.js"</span> ));
}

function AllTests()
{
    <a class="code" href="classTestSuite.html" title="A TestSuite is a composition of Tests.">TestSuite</a>.call( <span class="keyword">this</span>, <span class="stringliteral">"AllTests"</span> );
}
function AllTests_suite()
{
    var suite = <span class="keyword">new</span> AllTests();
    suite.addTest( ArrayTestSuite.prototype.suite());
    suite.addTest( MoneyTestSuite.prototype.suite());
    suite.addTest( SimpleTestSuite.prototype.suite());
    <span class="keywordflow">return</span> suite;
}
AllTests.prototype = <span class="keyword">new</span> <a class="code" href="classTestSuite.html" title="A TestSuite is a composition of Tests.">TestSuite</a>();
AllTests.prototype.suite = AllTests_suite;

var args;
<span class="keywordflow">if</span>( <span class="keyword">this</span>.WScript )
{
    args = <span class="keyword">new</span> <a class="code" href="classArray.html" title="Standard ECMA class.">Array</a>();
    <span class="keywordflow">for</span>( var i = 0; i &lt; WScript.Arguments.Count(); ++i )
        args[i] = WScript.Arguments( i );
}
<span class="keywordflow">else</span> <span class="keywordflow">if</span>( <span class="keyword">this</span>.arguments )
    args = arguments;
<span class="keywordflow">else</span>
    args = <span class="keyword">new</span> <a class="code" href="classArray.html" title="Standard ECMA class.">Array</a>();
    
var result = <a class="code" href="classTextTestRunner.html" title="Class for an application running test suites with a test based status report.">TextTestRunner</a>.prototype.main( args );
JsUtil.prototype.quit( result );

</pre></div><p>
This file can also be included from HTML code using a script tag. See AllScripts.html that demonstrated this reuse. <h3><a class="anchor" name="embed">
Embedding JsUnit</a></h3>
<p>
JsUnit provides a special <a class="el" href="classEmbeddedTextTestRunner.html" title="Class for an embeddable text-oriented TestRunner used in other applications with...">EmbeddedTextTestRunner</a> that can act as special entry point for other applications embedding JsUnit. Such a <a class="el" href="classTestRunner.html" title="TestRunner of JsUnit 1.1.">TestRunner</a> has a run method that takes an array of Strings as names of the tests to perform. The ideal combination is a <a class="el" href="classTestCollector.html" title="A collector for Test classes.">TestCollector</a> implementation that collects these names from the current scope. See as example:<p>
<div class="fragment"><pre class="fragment">var writer = <span class="keyword">new</span> <a class="code" href="classHTMLWriterFilter.html" title="A filter for a PrinterWriter encoding HTML.">HTMLWriterFilter</a>( JsUtil.prototype.getSystemWriter());
var printer = <span class="keyword">new</span> <a class="code" href="classClassicResultPrinter.html" title="The ResultPrinter of JsUnit 1.1.">ClassicResultPrinter</a>( writer );
var runner = <span class="keyword">new</span> <a class="code" href="classEmbeddedTextTestRunner.html" title="Class for an embeddable text-oriented TestRunner used in other applications with...">EmbeddedTextTestRunner</a>( printer );
var collector = <span class="keyword">new</span> <a class="code" href="classTestCaseCollector.html" title="A TestCase collector for all test cases within a scope.">TestCaseCollector</a>( <span class="keyword">this</span> );
runner.run( collector.collectTests());
</pre></div><p>
The <a class="el" href="classEmbeddedTextTestRunner.html" title="Class for an embeddable text-oriented TestRunner used in other applications with...">EmbeddedTextTestRunner</a> simply takes a <a class="el" href="classResultPrinter.html" title="Class to print the result of a TextTestRunner.">ResultPrinter</a> implementation as argument (here an implementation that writes HTML code into the document) and uses a <a class="el" href="classTestCaseCollector.html" title="A TestCase collector for all test cases within a scope.">TestCaseCollector</a> to find all available <a class="el" href="classTestCase.html" title="A test case defines the fixture to run multiple tests.">TestCase</a> implementations in the current scope. As alternative JsUnit provides also an <a class="el" href="classAllTestsCollector.html" title="A collector for the AllTests class.">AllTestsCollector</a> and a TestSuiteColector.<p>
<p>
Have a look at the Java code of the package to see how such a construct is used in combination with Rhino - a Java implementation of JavaScript - to generate XML for the various JUnit report generators:<p>
<div class="fragment"><pre class="fragment">                <span class="keyword">final</span> <a class="code" href="classString.html" title="Standard ECMA class.">String</a> xml = (<a class="code" href="classString.html" title="Standard ECMA class.">String</a>)context.evaluateString(scope, <span class="stringliteral">""</span>
                    + <span class="stringliteral">"var stringWriter = new StringWriter();\n"</span>
                    + <span class="stringliteral">"var runner = new EmbeddedTextTestRunner(new XMLResultPrinter(stringWriter));\n"</span>
                    + <span class="stringliteral">"var collector = new AllTestsCollector(this);\n"</span>
                    + <span class="stringliteral">"runner.run(collector.collectTests());\n"</span>
                    + <span class="stringliteral">"stringWriter.get();\n"</span>, <span class="stringliteral">"AllTests"</span>, 1, null);
                writer.write(xml);
</pre></div><h3><a class="anchor" name="examples">
Examples</a></h3>
The examples are also ports from the originals that accompany JUnit. Please note that the last test case of SimpleTest is supposed to fail to demonstrate this case.<p>
Most supported environments cannot share their test application. Therefore are a lot of AllTests*.* files part of the sample package. See the list below for all deliveries. Individual execution of the examples is available in the product specific documentation.<p>
<ul>
<li>
<a class="el" href="products.html#scriptengines">Script Engines</a> </li>
<li>
<a class="el" href="ant.html">Apache Ant</a> </li>
<li>
<a class="el" href="maven2.html">Apache Maven 2</a> </li>
</ul>
<p>
<table border="1" cellspacing="3" cellpadding="3">
<tr>
<td><b>Files</b> </td><td><b>Environment</b>  </td></tr>
<tr>
<td>AllTests.html<p>
</td><td>Any browser with a JavaScript implementation capable of exceptions<p>
</td></tr>
<tr>
<td>AllTests.vup<p>
</td><td>Project for Microsoft Visual Interdev<p>
</td></tr>
<tr>
<td>AllTests.wsf<p>
</td><td>Script for Windows Script Host. Run best with <em>cscript</em><p>
</td></tr>
<tr>
<td>AllTestsBV<br>
AllTestsBV.jsp<p>
</td><td>JavaScript Server Page of BroadVision's One-2-one server. Use the script AllTestsBV to start the <em>ctxdriver</em> for command line invocation.<p>
</td></tr>
<tr>
<td>AllTestsNS<br>
AllTestsNS.html<p>
</td><td>Netscape SSJS application. The shell script uses <em>jsac</em> to compile the web application. The script generates a web file from the HTML source and the other used files.<p>
</td></tr>
<tr>
<td>AllTests.js<p>
</td><td>JavaScript to use with the JavaScript shells. For the Mozilla shells use <em>java -jar js.jar</em> to run <em>Rhino</em> built from Java source or use <em>jsshell</em> resp. <em>js</em> to run <em>SpiderMonkey</em> built from C source. You may also use <em>cscript</em> for this file or <em>kjscmd</em>.<p>
</td></tr>
<tr>
<td>build.xml<p>
</td><td><a class="el" href="ant.html">Apache Ant</a> build file that runs the Ant Task for JsUnit tests with the help of <em>Rhino</em>. A test report is generated that can be processed by <em>JUnitReport</em>.<p>
</td></tr>
<tr>
<td>pom.xml<p>
</td><td>Maven 2 project description file that runs the Maven 2 plugin for JsUnit tests with the help of <em>Rhino</em>. A test report is generated that can be processed by the <em>Surefire Report</em> plugin.<p>
</td></tr>
</table>
<p>
 

</div>

 <hr>
<table width="100%" class="header">
    <tr>
        <td>
            <div align="left">
            <small>JsUnit &copy; 1999, 2000, 2001, 2002, 2003, 2006, 2007 by J&ouml;rg Schaible</small>
            </div>
        </td>
        <td>
            <div align="right">
                <small>Generated on Fri Oct 19 23:10:41 2007 for <b>JsUnit</b> by <a href="http://www.doxygen.org/index.html">doxygen</a> 1.5.2</small>
            </div>
        </td>
    </tr>
</table>
</body>
</html>
